{
	"appsUsed":[
		
	],
	"createdTime":1722865387940,
	"deleted":false,
	"deploymentState":{
		"deployedAt":1758646537239,
		"deployedBy":0,
		"deployedDefinitionId":"68d2d1099f85565fb8fa5daf",
		"status":"DEPLOYED",
		"version":47,
		"workflowVersion":96
	},
	"edges":[
		{
			"fromNodeId":"Br0kj",
			"priority":0,
			"skip":false,
			"toNodeId":"UvBEc",
			"type":"next"
		},
		{
			"fromNodeId":"UvBEc",
			"priority":0,
			"skip":false,
			"toNodeId":"Kmbo7",
			"type":"next"
		},
		{
			"fromNodeId":"Kmbo7",
			"name":"1",
			"priority":0,
			"skip":false,
			"toNodeId":"Kmbo7@1",
			"type":"branch"
		},
		{
			"fromNodeId":"Kmbo7@1",
			"priority":0,
			"skip":false,
			"toNodeId":"p49aT",
			"type":"next"
		},
		{
			"fromNodeId":"p49aT",
			"priority":0,
			"skip":false,
			"toNodeId":"skiQo",
			"type":"next"
		},
		{
			"fromNodeId":"Kmbo7",
			"name":"2",
			"priority":0,
			"skip":false,
			"toNodeId":"Kmbo7@2",
			"type":"branch"
		},
		{
			"fromNodeId":"Kmbo7@2",
			"priority":0,
			"skip":false,
			"toNodeId":"tKfAl",
			"type":"next"
		},
		{
			"fromNodeId":"tKfAl",
			"priority":0,
			"skip":false,
			"toNodeId":"IizGF",
			"type":"next"
		},
		{
			"fromNodeId":"Kmbo7",
			"name":"default",
			"priority":0,
			"skip":false,
			"toNodeId":"h3Qn7",
			"type":"branch"
		},
		{
			"fromNodeId":"skiQo",
			"priority":0,
			"skip":false,
			"toNodeId":"w6oSp",
			"type":"next"
		},
		{
			"fromNodeId":"IizGF",
			"priority":0,
			"skip":false,
			"toNodeId":"w6oSp",
			"type":"next"
		},
		{
			"fromNodeId":"h3Qn7",
			"priority":0,
			"skip":false,
			"toNodeId":"w6oSp",
			"type":"next"
		},
		{
			"fromNodeId":"w6oSp",
			"priority":0,
			"skip":false,
			"toNodeId":"pqKrs",
			"type":"next"
		}
	],
	"grants":{
		"configs":[
			{
				"permissions":[
					"V"
				],
				"principalType":"GLOBAL"
			}
		]
	},
	"id":"66b0d6eb9fc8e7058b7b0fe5",
	"lastModifiedBy":0,
	"lcName":"gaurdrail automation",
	"modifiedTime":1758655359093,
	"name":"Gaurdrail Automation",
	"nodes":[
		{
			"context":{
				"appName":"callables",
				"resourceVersion":46,
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"j04FG-1",
			"id":"Br0kj",
			"index":0,
			"inputs":{
				"result":{
					"type":"object",
					"properties":{
						"success":{
							"type":"boolean",
							"title":"Success",
							"default":false
						},
						"responseMessage":{
							"type":"string",
							"title":"Response Message"
						},
						"modifiedQuery":{
							"type":"string",
							"title":"Modified Query"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"setup":{
					"type":"object",
					"properties":{
						"knowledgeId":{
							"type":"string",
							"title":"Knowledge Id"
						},
						"CustomWords":{
							"type":"array",
							"items":{
								"type":"string"
							},
							"title":"Custom Words"
						},
						"aiAgentId":{
							"type":"string",
							"title":"Ai Agent Id"
						},
						"guardrailType":{
							"type":"string",
							"title":"Guardrail Type"
						},
						"userQuery":{
							"type":"string",
							"title":"User Query"
						},
						"patterns":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"Patterns"
						}
					},
					"additionalProperties":false,
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger from automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":114,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"j04FG-1",
			"id":"UvBEc",
			"index":0,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"ui:submitButtonOptions":{
						"norender":true
					}
				},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"responseMessage":{
							"type":"string",
							"title":"Response Message"
						},
						"success":{
							"type":"boolean",
							"title":"Success",
							"default":false
						}
					},
					"required":[]
				}
			},
			"inputs":{
				"success":false
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"responseMessage":{
							"type":"string",
							"title":"Response Message"
						},
						"success":{
							"type":"boolean",
							"title":"Success",
							"default":false
						}
					},
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"branch",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"j04FG-1",
			"id":"Kmbo7",
			"index":0,
			"inputs":{
				"branches":[
					{
						"id":"1",
						"inputs":{
							"name":"Custom Word Filter",
							"conditions":{
								"filters":[
									{
										"property":"{{ Br0kj.outputs.guardrailType }}",
										"filter":{
											"operator":"EQUAL",
											"value":"CustomWordFilter"
										}
									}
								],
								"operator":"AND"
							}
						}
					},
					{
						"id":"2",
						"inputs":{
							"name":"Regex Pattern",
							"conditions":{
								"filters":[
									{
										"property":"{{ Br0kj.outputs.guardrailType }}",
										"filter":{
											"operator":"EQUAL",
											"value":"RegexPattern"
										}
									}
								],
								"operator":"AND"
							}
						}
					},
					{
						"id":"default"
					}
				]
			},
			"skip":false,
			"subTitle":"Branch",
			"title":"",
			"type":"BRANCH"
		},
		{
			"context":{
				"appName":"branch_condition",
				"resourceVersion":34,
				"resourceName":"branch_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Kmbo7@j04FG-1@1",
			"id":"Kmbo7@1",
			"index":0,
			"inputs":{
				"name":"Custom Word Filter",
				"conditions":{
					"filters":[
						{
							"property":"{{ Br0kj.outputs.guardrailType }}",
							"filter":{
								"operator":"EQUAL",
								"value":"CustomWordFilter"
							}
						}
					],
					"operator":"AND"
				}
			},
			"skip":false,
			"title":"",
			"type":"BRANCH_CONDITION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":52,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Kmbo7@j04FG-1@1",
			"id":"p49aT",
			"index":0,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"success":{
							"type":"boolean",
							"title":"Success",
							"default":false
						},
						"responseMessage":{
							"type":"string",
							"title":"Response Message"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"userQuery":{
							"type":"string",
							"title":"User Query"
						},
						"customWords":{
							"type":"array",
							"items":{
								"type":"string"
							},
							"title":"Custom Words"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"code":"def checkUserQuery(String userQuery, List<String> customWords) {\n    def success = false\n    def responseMessage = \"\"\n    \n    // Split the userQuery into sentences\n    def sentences = userQuery.split(/(?<=[.!?])\\s+/)\n    \n    // Check if any sentence contains any of the custom words\n    def hasMatchingSentences = sentences.any { sentence ->\n        customWords.any { word ->\n            sentence.toLowerCase().contains(word.toLowerCase())\n        }\n    }\n    \n    if (hasMatchingSentences) {\n        success = true\n        responseMessage = \"Sentences containing specified words or phrases found.\"\n    } else {\n        success = false\n        responseMessage = \"No sentences containing specified words or phrases found.\"\n    }\n    \n    return [\n        \"success\": success,\n        \"responseMessage\": responseMessage\n    ]\n}\n\n\ndef output = checkUserQuery(userQuery, customWords)\nreturn output\n",
				"parameters":{
					"userQuery":"{{ Br0kj.outputs.userQuery }}",
					"customWords":{
						"source":"{{ Br0kj.outputs.CustomWords }}",
						"ua:type":"mappedArray",
						"items":"{{ Br0kj.outputs.CustomWords }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Code By UnifyApps",
			"title":"Execute groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":56,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Kmbo7@j04FG-1@1",
			"id":"skiQo",
			"index":0,
			"inputs":{
				"variables":[
					{
						"source":"{{ UvBEc.outputs.responseMessage }}",
						"value":"{{ p49aT.outputs.result.responseMessage }}"
					},
					{
						"source":"{{ UvBEc.outputs.success }}",
						"value":"{{ p49aT.outputs.result.success }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"branch_condition",
				"resourceVersion":34,
				"resourceName":"branch_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Kmbo7@j04FG-1@2",
			"id":"Kmbo7@2",
			"index":0,
			"inputs":{
				"name":"Regex Pattern",
				"conditions":{
					"filters":[
						{
							"property":"{{ Br0kj.outputs.guardrailType }}",
							"filter":{
								"operator":"EQUAL",
								"value":"RegexPattern"
							}
						}
					],
					"operator":"AND"
				}
			},
			"skip":false,
			"title":"",
			"type":"BRANCH_CONDITION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":52,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Kmbo7@j04FG-1@2",
			"id":"tKfAl",
			"index":0,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"responseMessage":{
							"type":"string",
							"title":"Response Message"
						},
						"success":{
							"type":"boolean",
							"title":"Success",
							"default":false
						},
						"modifiedQuery":{
							"type":"string",
							"title":"Modified Query"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"userQuery":{
							"type":"string",
							"title":"User Query"
						},
						"patterns":{
							"type":"array",
							"items":{
								"type":"string"
							},
							"title":"Patterns"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"code":"import java.util.regex.Pattern\n\ndef checkUserQuery(String userQuery, List<Map> patterns) {\n    def success = true\n    def responseMessage = \"Query processed successfully.\"\n    def modifiedQuery = userQuery\n    def blocked = false\n\n    patterns.each { pattern ->\n        def regex = Pattern.compile(pattern.regex)\n        def matcher = regex.matcher(modifiedQuery)\n\n        while (matcher.find()) {\n            if (pattern.guardrailBehaviour == \"Block\") {\n                blocked = true\n                success = false\n                responseMessage = \"Query blocked due to sensitive information.\"\n                return  // Exit the closure early\n            } else if (pattern.guardrailBehaviour == \"Mask\") {\n                def sensitiveInfo = matcher.group()\n                def maskedInfo = \"*\" * sensitiveInfo.length()\n                modifiedQuery = modifiedQuery.replaceFirst(Pattern.quote(sensitiveInfo), maskedInfo)\n            }\n        }\n    }\n\n    if (blocked) {\n        return [\n            \"success\": success,\n            \"responseMessage\": responseMessage\n        ]\n    } else {\n        return [\n            \"success\": success,\n            \"responseMessage\": responseMessage,\n            \"modifiedQuery\": modifiedQuery\n        ]\n    }\n}\n\n\ndef output = checkUserQuery(userQuery, patterns)\nreturn output\n",
				"parameters":{
					"userQuery":"{{ Br0kj.outputs.userQuery }}",
					"patterns":{
						"source":"{{ Br0kj.outputs.patterns }}",
						"ua:type":"mappedArray",
						"items":"{{ Br0kj.outputs.patterns }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Code By UnifyApps",
			"title":"Execute groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":56,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Kmbo7@j04FG-1@2",
			"id":"IizGF",
			"index":0,
			"inputs":{
				"variables":[
					{
						"source":"{{ UvBEc.outputs.responseMessage }}",
						"value":"{{ tKfAl.outputs.result.responseMessage }}"
					},
					{
						"source":"{{ UvBEc.outputs.success }}",
						"value":"{{ tKfAl.outputs.result.success }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":56,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Kmbo7@j04FG-1@default",
			"id":"h3Qn7",
			"index":0,
			"inputs":{
				"variables":[
					{
						"source":"{{ UvBEc.outputs.responseMessage }}",
						"value":"Please choose correct Guardrail type"
					},
					{
						"source":"{{ UvBEc.outputs.success }}",
						"value":false
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":42,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"j04FG-1",
			"id":"w6oSp",
			"index":0,
			"inputs":{
				"result":{
					"success":"{{ UvBEc.outputs.responseMessage }}",
					"responseMessage":"{{ UvBEc.outputs.success }}",
					"modifiedQuery":"{{ tKfAl.outputs.result.modifiedQuery }}"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		},
		{
			"context":{
				"appName":"stop"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"j04FG-1",
			"id":"pqKrs",
			"index":0,
			"skip":false,
			"subTitle":"Stop",
			"title":"Stop",
			"type":"STOP"
		}
	],
	"ownerUserId":520,
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":true,
	"tags":[
		"AI Agent"
	],
	"version":97
}