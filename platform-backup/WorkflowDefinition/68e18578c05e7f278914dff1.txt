{
	"appsUsed":[
		
	],
	"createdTime":1759610232579,
	"deleted":false,
	"deploymentState":{
		"deployedAt":1759614611205,
		"deployedBy":15430,
		"deployedDefinitionId":"68e1969344c0a32bec56c0d8",
		"status":"DEPLOYED",
		"version":2,
		"workflowVersion":9
	},
	"edges":[
		{
			"fromNodeId":"n_P5CXD",
			"priority":0,
			"skip":false,
			"toNodeId":"n_Ny3nr",
			"type":"next"
		},
		{
			"fromNodeId":"n_Ny3nr",
			"priority":0,
			"skip":false,
			"toNodeId":"n_l93OP",
			"type":"next"
		},
		{
			"fromNodeId":"n_l93OP",
			"priority":0,
			"skip":false,
			"toNodeId":"n_1TiPd",
			"type":"next"
		},
		{
			"fromNodeId":"n_1TiPd",
			"priority":0,
			"skip":false,
			"toNodeId":"n_lvXll",
			"type":"next"
		},
		{
			"fromNodeId":"n_lvXll",
			"priority":0,
			"skip":false,
			"toNodeId":"_8aijN",
			"type":"next"
		},
		{
			"fromNodeId":"_8aijN",
			"priority":0,
			"skip":false,
			"toNodeId":"n_zfngo",
			"type":"next"
		},
		{
			"fromNodeId":"n_zfngo",
			"priority":0,
			"skip":false,
			"toNodeId":"n_oqCHf",
			"type":"next"
		}
	],
	"id":"68e18578c05e7f278914dff1",
	"lastModifiedBy":44096,
	"lcName":"publish nearest tool ",
	"modifiedTime":1759617093923,
	"name":"Publish Nearest Tool ",
	"nodes":[
		{
			"context":{
				"appName":"callables",
				"resourceVersion":1011,
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":true,
			"fallbackMode":"STOP",
			"groupId":"_CkHE4-1",
			"id":"n_P5CXD",
			"index":1,
			"inputs":{
				"result":{
					"type":"object",
					"additionalProperties":false,
					"required":[
						"ef"
					],
					"properties":{
						"ef":{
							"type":"string",
							"title":"Ef"
						}
					}
				},
				"setup":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"distance":{
							"type":"string",
							"title":"Distance"
						},
						"rating":{
							"type":"object",
							"properties":{
								"greaterThanEqualToValue":{
									"type":"number",
									"title":"Greater Than Equal To Value"
								},
								"lessThanEqualToValue":{
									"type":"number",
									"title":"Less Than Equal To Value"
								}
							},
							"additionalProperties":false,
							"title":"Rating",
							"required":[]
						},
						"storeName":{
							"type":"string",
							"title":"Store Name"
						},
						"count":{
							"type":"number",
							"title":"Count"
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger via automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":96,
				"resourceName":"variable_by_unifyapps_get_session_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":true,
			"fallbackMode":"STOP",
			"groupId":"_CkHE4-1",
			"id":"n_Ny3nr",
			"index":2,
			"inputs":{
				"variableSchema":{
					"type":"object",
					"properties":{
						"caseId":{
							"type":"string",
							"title":"Case Id"
						}
					},
					"additionalProperties":false,
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Get Session Variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":70,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":true,
			"fallbackMode":"STOP",
			"groupId":"_CkHE4-1",
			"id":"n_l93OP",
			"index":3,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"lat":{
							"type":"number",
							"title":"Lat"
						},
						"long":{
							"type":"number",
							"title":"Long"
						}
					},
					"required":[
						"lat",
						"long"
					]
				}
			},
			"inputs":{
				"lat":25.18813,
				"long":55.29744
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"lat":{
							"type":"number",
							"title":"Lat"
						},
						"long":{
							"type":"number",
							"title":"Long"
						}
					},
					"required":[
						"lat",
						"long"
					]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"standard_entities",
				"resourceVersion":263,
				"resourceName":"standard_entities_fetch_user",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":true,
			"fallbackMode":"STOP",
			"groupId":"_CkHE4-1",
			"id":"n_1TiPd",
			"index":4,
			"inputs":{
				"fetchBy":"id",
				"applicationId":"dda-16",
				"user":"{{ __USER__.outputs.id }}"
			},
			"skip":true,
			"subTitle":"Standard entities by UnifyApps",
			"title":"Fetch User",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.parameters.location.lat",
					"root.parameters.location.lon",
					"root.parameters.rating.greaterThanEqualToValue",
					"root.parameters.rating.lessThanEqualToValue"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":0,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":true,
			"fallbackMode":"STOP",
			"groupId":"_CkHE4-1",
			"id":"n_lvXll",
			"index":5,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"sort":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"Sort"
						},
						"query":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Query"
						}
					}
				},
				"input":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"location":{
							"type":"object",
							"properties":{
								"lat":{
									"type":"number",
									"title":"Lat"
								},
								"lon":{
									"type":"number",
									"title":"Lon"
								}
							},
							"additionalProperties":false,
							"title":"Location",
							"required":[]
						},
						"rating":{
							"type":"object",
							"properties":{
								"greaterThanEqualToValue":{
									"type":"number",
									"title":"Greater Than Equal To Value"
								},
								"lessThanEqualToValue":{
									"type":"number",
									"title":"Less Than Equal To Value"
								}
							},
							"additionalProperties":false,
							"title":"Rating",
							"required":[]
						},
						"distance":{
							"type":"string",
							"title":"Distance"
						},
						"storeName":{
							"type":"string",
							"title":"Store Name"
						}
					}
				},
				"code":"def needQuery = false\ndef ratingQuery = null\ndef filter = null\ndef sort = null\n\nif (binding.hasVariable('rating') && rating instanceof Map && !rating.isEmpty()) {\n    def gte = null\n    def lte = null\n\n    if (rating.containsKey('greaterThanEqualToValue') && rating.greaterThanEqualToValue.toString().trim()) {\n        gte = (Double) rating.greaterThanEqualToValue\n        needQuery = true\n    }\n    if (rating.containsKey('lessThanEqualToValue') && rating.lessThanEqualToValue.toString().trim()) {\n        lte = (Double) rating.lessThanEqualToValue\n        needQuery = true\n    }\n\n    if (needQuery) {\n        def rangePart = [:]\n        if (gte != null) rangePart.gte = gte\n        if (lte != null) rangePart.lte = lte\n\n        ratingQuery = [\"range\": [\"properties.rating\": rangePart]]\n    }\n}\n\nif (binding.hasVariable('location') && location instanceof Map && location.lat && location.lon) {\n    def latVal = location.lat\n    def lonVal = location.lon\n\n    if (latVal && lonVal) {\n        def lat = (Double) latVal\n        def lon = (Double) lonVal\n\n        if (binding.hasVariable('distance') && distance.toString().trim()) {\n            needQuery = true\n            filter = [\n                \"geo_distance\": [\n                    \"distance\": distance,\n                    \"properties.location\": [\"lat\": lat, \"lon\": lon]\n                ]\n            ]\n        }\n\n        sort = [\n            \"_geo_distance\": [\n                \"properties.location\": [\"lat\": lat, \"lon\": lon],\n                \"order\": \"asc\",\n                \"unit\": \"km\",\n                \"mode\": \"min\",\n                \"distance_type\": \"arc\"\n            ]\n        ]\n    }\n}\n\ndef queryObject = null\nif (needQuery) {\n    queryObject = [\"bool\": [:]]\n\n    if (ratingQuery != null) {\n        queryObject.bool[\"must\"] = [ratingQuery]\n    }\n    if (filter != null) {\n        queryObject.bool[\"filter\"] = filter\n    }\n}\n\nreturn [\n    \"query\": queryObject ?: [:],\n    \"sort\": sort ? [sort] : []\n]\n",
				"compile_static":false,
				"captureStdOutput":false,
				"parameters":{
					"location":{
						"lat":"{{ n_l93OP.outputs.lat }}",
						"lon":"{{ n_l93OP.outputs.long }}"
					},
					"rating":{
						"greaterThanEqualToValue":"{{ n_P5CXD.outputs.rating.greaterThanEqualToValue }}",
						"lessThanEqualToValue":"{{ n_P5CXD.outputs.rating.lessThanEqualToValue }}"
					},
					"distance":"{{ n_P5CXD.outputs.distance }}",
					"storeName":"{{ n_P5CXD.outputs.storeName }}"
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"additional":{
				"xsdSchemaConfig":{
					"root":{}
				}
			},
			"context":{
				"appName":"custom_http_endpoint",
				"resourceVersion":162,
				"resourceName":"custom_http_endpoint_execute",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":true,
			"fallbackMode":"STOP",
			"groupId":"_CkHE4-1",
			"id":"_8aijN",
			"index":6,
			"inputs":{
				"isAsync":false,
				"enableProxy":false,
				"requestTimeoutInSecs":-1,
				"httpMethod":"POST",
				"body":{
					"size":10,
					"query":"{{ n_lvXll.outputs.result.query }}",
					"sort":{
						"source":"{{ n_lvXll.outputs.result.sort }}",
						"ua:type":"mappedArray",
						"items":"{{ n_lvXll.outputs.result.sort[0] }}"
					}
				},
				"connectionType":"DIRECT",
				"sslVerify":false,
				"path":"/geosearch_dda_dnd_1/_search?pretty",
				"baseUrl":"http://opensearch-app-svc.unifyapps-infra.svc.cluster.local:9200",
				"httpVersion":"HTTP_2",
				"bodySchema":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"size":{
							"type":"integer",
							"title":"size"
						},
						"query":{
							"type":"object",
							"title":"query"
						},
						"sort":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"sort"
						}
					}
				},
				"responseContentType":"application/json",
				"followRedirects":"NORMAL",
				"authType":"CUSTOM",
				"requestContentType":"application/json",
				"ignoreTrailingSlashes":false,
				"certificateType":"CERT_STRING"
			},
			"skip":false,
			"subTitle":"Custom HTTP Endpoint",
			"title":"Execute REST request",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":52,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":true,
			"fallbackMode":"STOP",
			"groupId":"_CkHE4-1",
			"id":"n_zfngo",
			"index":7,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"additionalProperties":false,
									"type":[
										"object",
										"string",
										"number",
										"boolean",
										"integer"
									],
									"properties":{}
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray",
					"source":"{{ n_8TSHY.outputs.objects }}",
					"items":"{{ n_8TSHY.outputs.objects[0] }}"
				},
				"ua:title":"storesNearMeWithDiscounts",
				"ua:list_type":"STRING"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"storesNearMeWithDiscounts",
							"disableActions":true,
							"items":{
								"type":"string"
							}
						}
					}
				}
			},
			"skip":true,
			"subTitle":"Variable by UnifyApps",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":106,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":true,
			"fallbackMode":"STOP",
			"groupId":"_CkHE4-1",
			"id":"n_oqCHf",
			"index":8,
			"inputs":{
				"result":{
					"ef":"dfdf"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":15430,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":false,
	"tags":[
		
	],
	"version":18
}