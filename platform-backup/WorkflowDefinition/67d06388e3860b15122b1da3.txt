{
	"appsUsed":[
		"storage_by_unifyapps"
	],
	"createdTime":1741883466750,
	"deleted":false,
	"deploymentState":{
		"deployedAt":1759243644899,
		"deployedBy":-1,
		"deployedDefinitionId":"68dbed7c23e6682b9a51ed86",
		"status":"DEPLOYED",
		"version":58,
		"workflowVersion":103
	},
	"edges":[
		{
			"fromNodeId":"nmw8k",
			"priority":0,
			"skip":false,
			"toNodeId":"exF5M",
			"type":"next"
		},
		{
			"fromNodeId":"exF5M",
			"priority":0,
			"skip":false,
			"toNodeId":"OM2SU",
			"type":"next"
		},
		{
			"fromNodeId":"OM2SU",
			"priority":0,
			"skip":false,
			"toNodeId":"1TDAJ",
			"type":"next"
		},
		{
			"fromNodeId":"1TDAJ",
			"priority":0,
			"skip":false,
			"toNodeId":"PnpuH",
			"type":"next"
		},
		{
			"fromNodeId":"PnpuH",
			"priority":0,
			"skip":false,
			"toNodeId":"PrtLZ",
			"type":"next"
		},
		{
			"fromNodeId":"PrtLZ",
			"priority":0,
			"skip":false,
			"toNodeId":"1LOZ8",
			"type":"next"
		},
		{
			"fromNodeId":"1LOZ8",
			"priority":0,
			"skip":false,
			"toNodeId":"nkuN3",
			"type":"next"
		},
		{
			"fromNodeId":"nkuN3",
			"priority":0,
			"skip":false,
			"toNodeId":"RexDI",
			"type":"next"
		},
		{
			"fromNodeId":"RexDI",
			"name":"1",
			"priority":0,
			"skip":false,
			"toNodeId":"RexDI@1",
			"type":"branch"
		},
		{
			"fromNodeId":"RexDI@1",
			"priority":0,
			"skip":false,
			"toNodeId":"PZgsl",
			"type":"next"
		},
		{
			"fromNodeId":"PZgsl",
			"priority":0,
			"skip":false,
			"toNodeId":"lmftR",
			"type":"next"
		},
		{
			"fromNodeId":"lmftR",
			"priority":0,
			"skip":false,
			"toNodeId":"TeQ1t",
			"type":"next"
		},
		{
			"fromNodeId":"RexDI",
			"name":"2",
			"priority":0,
			"skip":false,
			"toNodeId":"RexDI@2",
			"type":"branch"
		},
		{
			"fromNodeId":"RexDI@2",
			"priority":0,
			"skip":false,
			"toNodeId":"TIo2O",
			"type":"next"
		},
		{
			"fromNodeId":"TIo2O",
			"priority":0,
			"skip":false,
			"toNodeId":"6hj7U",
			"type":"next"
		},
		{
			"fromNodeId":"RexDI",
			"name":"default",
			"priority":0,
			"skip":false,
			"toNodeId":"rjEde",
			"type":"branch"
		},
		{
			"fromNodeId":"TeQ1t",
			"priority":0,
			"skip":false,
			"toNodeId":"I4rUi",
			"type":"next"
		},
		{
			"fromNodeId":"6hj7U",
			"priority":0,
			"skip":false,
			"toNodeId":"I4rUi",
			"type":"next"
		},
		{
			"fromNodeId":"rjEde",
			"priority":0,
			"skip":false,
			"toNodeId":"I4rUi",
			"type":"next"
		}
	],
	"grants":{
		"configs":[
			{
				"permissions":[
					"V"
				],
				"principalType":"GLOBAL"
			}
		]
	},
	"id":"67d06388e3860b15122b1da3",
	"lastModifiedBy":-1,
	"lcName":"fetchdynamicschema tool",
	"modifiedTime":1759371962116,
	"name":"FetchDynamicSchema Tool",
	"nodes":[
		{
			"context":{
				"appName":"callables",
				"resourceVersion":130,
				"resourceName":"callables_from_interface"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HOIMK-1",
			"id":"nmw8k",
			"index":0,
			"inputs":{
				"result":{
					"additionalProperties":false,
					"ua:modal":{
						"field_type":"STRING",
						"is_optional":true
					},
					"type":"object",
					"properties":{
						"toolOutput":{
							"type":"string",
							"title":"toolOutput"
						},
						"success":{
							"type":"boolean",
							"title":"Success"
						},
						"error":{
							"type":"string",
							"title":"Error"
						}
					},
					"required":[]
				},
				"callableInterfaceId":"679484ef9c8ab5620dca9609",
				"setup":{
					"additionalProperties":false,
					"ua:modal":{
						"field_type":"STRING",
						"is_optional":true
					},
					"type":"object",
					"properties":{
						"toolId":{
							"type":"string",
							"title":"toolId"
						},
						"toolInputs":{
							"type":"object",
							"title":"toolInputs"
						},
						"triggeredByAgentId":{
							"type":"string",
							"title":"Triggered By Agent Id"
						},
						"agentResponseMessageId":{
							"type":"string",
							"title":"Agent Response Message Id"
						}
					},
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger interface",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":136,
				"resourceName":"variable_by_unifyapps_get_session_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HOIMK-1",
			"id":"exF5M",
			"index":0,
			"inputs":{
				"variableSchema":{
					"type":"object",
					"properties":{
						"caseId":{
							"type":"string",
							"title":"Case Id"
						},
						"ai_agent_use_deployed_entity":{
							"type":"boolean",
							"title":"Ai Agent Use Deployed Entity"
						},
						"ai_agent_deployed_version":{
							"type":"integer",
							"title":"Ai Agent Deployed Version"
						}
					},
					"additionalProperties":false,
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Get Session Variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":140,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HOIMK-1",
			"id":"OM2SU",
			"index":0,
			"inputs":{
				"automationId":"67e26f9c2807cf04c7f860db",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"agentId":"{{ nmw8k.outputs.triggeredByAgentId }}",
					"caseId":"{{ exF5M.outputs.caseId }}"
				}
			},
			"skip":false,
			"subTitle":"Get available tools",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.parameters.availableTools.items"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":135,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HOIMK-1",
			"id":"1TDAJ",
			"index":0,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"actionId":{
							"type":"string",
							"title":"Action Id"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"availableTools":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"Available Tools"
						},
						"toolName":{
							"type":"string",
							"title":"Tool Name"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"if (!binding.hasVariable(\"availableTools\")){\n  return [:]\n}\n\nreturn [\"actionId\":availableTools.find{it.name == toolName}.id]",
				"parameters":{
					"toolName":"=MAPGET({{ nmw8k.outputs.toolInputs }},\"toolName\")",
					"availableTools":{
						"source":"{{ OM2SU.outputs.availableTools }}",
						"ua:type":"mappedArray",
						"items":"{{ OM2SU.outputs.availableTools[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":2,
				"resourceName":"storage_by_unifyapps_get_record_by_id",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HOIMK-1",
			"id":"PnpuH",
			"index":0,
			"inputs":{
				"object_type":"e_action_ai_agent",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"id":"{{ 1TDAJ.outputs.result.actionId }}",
				"readThroughSessionVariables":true
			},
			"skip":false,
			"subTitle":"Storage by UnifyApps",
			"title":"Fetch record by ID",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"custom_application",
				"resourceVersion":28,
				"resourceName":"custom_application_fetch_input_schema",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HOIMK-1",
			"id":"PrtLZ",
			"index":0,
			"inputs":{
				"context":"{{ PnpuH.outputs.properties.context }}"
			},
			"skip":false,
			"subTitle":"Action schema",
			"title":"Fetch Input Schema",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":133,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HOIMK-1",
			"id":"1LOZ8",
			"index":0,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"options":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Options"
						},
						"key":{
							"type":"string",
							"title":"Key"
						},
						"operationId":{
							"type":"string",
							"title":"Operation Id"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"toolInputs":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Tool Inputs"
						},
						"actionSchema":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Action Schema"
						},
						"connectionId":{
							"type":"string",
							"title":"Connection Id"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"if (!binding.hasVariable(\"toolInputs\") || !binding.hasVariable(\"actionSchema\")){\n  return[:]\n}\n\nString fieldName = toolInputs.get(\"fieldName\")\nif (fieldName != null && fieldName.startsWith(\"_ua_schema_override_.\")) {\n  fieldName = fieldName.substring(21)\n}\ndef requirements = toolInputs.get(\"requirements\")\ndef fieldLayout = fetchFieldLayout(fieldName, actionSchema.schema?.properties, actionSchema.layout)\ndef operationId = fieldLayout?.get(\"ui:options\")?.get(\"ua:operationId\")\n\ndef template = null\nif (operationId == \"getConnectorObject\") {\n  template = fieldLayout?.get(\"ui:options\")?.get(\"ua:payload\")?.get(\"object\")\n  key = resolveKey(requirements, template)\n} else if (operationId == \"getEntityType\") {\n  template = fieldLayout?.get(\"ui:options\")?.get(\"ua:payload\")?.get(\"entityType\")\n}\ndef key = resolveKey(requirements, template)\n\n\nreturn [\n  \"options\" : [\n    \"connectionId\": (binding.hasVariable('connectionId') ? connectionId : \"\"),\n    \"source_resource_name\": fieldLayout?.get(\"ui:options\")?.get(\"ua:payload\")?.get(\"objectSourceResourceName\")\n  ],\n  \"key\": key,\n  \"operationId\": operationId\n]\n\n\ndef fetchFieldLayout(String fieldName, def properties, def layout) {\n    def finalFieldLayout = null\n    properties.each { propName, propValue ->\n        def layoutProps = layout.get(propName)\n        if (layoutProps?.get(\"ui:field\") == \"DynamicSchemaField\") {\n            def dynamicFieldName = layoutProps?.get(\"ui:options\")?.get(\"ua:field_name\")\n            if (fieldName == dynamicFieldName){\n                finalFieldLayout = layoutProps\n            }\n        }\n        if (propValue.type == \"object\" && propValue.properties != null && layoutProps != null) {\n            def fieldLayout = fetchFieldLayout(fieldName, propValue.properties, layoutProps)\n            if (fieldLayout != null){\n              finalFieldLayout = fieldLayout\n            }\n        }\n    }\n    return finalFieldLayout\n}\n\nString resolveKey(def requirements, def keyTemplate) {\n  return keyTemplate?.replaceAll(/\\{\\{(\\s*[\\w\\.]+\\s*)\\}\\}/) { match, key ->\n        def field = key.trim()\n        return requirements.containsKey(field) ? requirements[field] : match\n    }\n}",
				"parameters":{
					"toolInputs":"{{ nmw8k.outputs.toolInputs }}",
					"actionSchema":"{{ PrtLZ.outputs.inputSchema }}",
					"connectionId":"{{ PnpuH.outputs.properties.context.connectionId }}"
				}
			},
			"skip":false,
			"subTitle":"Resolve lookup inputs",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":162,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HOIMK-1",
			"id":"nkuN3",
			"index":0,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"schema":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Schema"
						}
					},
					"required":[]
				}
			},
			"inputs":{},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"schema":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Schema"
						}
					},
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"branch",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HOIMK-1",
			"id":"RexDI",
			"index":0,
			"inputs":{
				"branches":[
					{
						"id":"1",
						"inputs":{
							"name":"getConnectorObject",
							"conditions":{
								"filters":[
									{
										"property":"{{ 1LOZ8.outputs.result.operationId }}",
										"filter":{
											"operator":"EQUAL",
											"value":"getConnectorObject"
										}
									}
								],
								"operator":"AND"
							}
						}
					},
					{
						"id":"2",
						"inputs":{
							"name":"getEntityType",
							"conditions":{
								"filters":[
									{
										"property":"{{ 1LOZ8.outputs.result.operationId }}",
										"filter":{
											"operator":"EQUAL",
											"value":"getEntityType"
										}
									}
								],
								"operator":"AND"
							}
						}
					},
					{
						"id":"default"
					}
				]
			},
			"skip":false,
			"subTitle":"Branch",
			"title":"",
			"type":"BRANCH"
		},
		{
			"context":{
				"appName":"branch_condition",
				"resourceVersion":168,
				"resourceName":"branch_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"RexDI@HOIMK-1@1",
			"id":"RexDI@1",
			"index":0,
			"inputs":{
				"name":"getConnectorObject",
				"conditions":{
					"filters":[
						{
							"property":"{{ 1LOZ8.outputs.result.operationId }}",
							"filter":{
								"operator":"EQUAL",
								"value":"getConnectorObject"
							}
						}
					],
					"operator":"AND"
				}
			},
			"skip":false,
			"title":"",
			"type":"BRANCH_CONDITION"
		},
		{
			"context":{
				"appName":"standard_entities",
				"resourceVersion":133,
				"resourceName":"standard_entities_lookup_entities",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"RexDI@HOIMK-1@1",
			"id":"PZgsl",
			"index":0,
			"inputs":{
				"keys":[
					"{{ 1LOZ8.outputs.result.key }}"
				],
				"options":"{{ 1LOZ8.outputs.result.options }}",
				"lookupType":"CONNECTOR_OBJECT",
				"type":"ByKeys"
			},
			"skip":false,
			"subTitle":"Standard entities by UnifyApps",
			"title":"Lookup Request",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":135,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"RexDI@HOIMK-1@1",
			"id":"lmftR",
			"index":0,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"schema":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Schema"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"response":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Response"
						},
						"key":{
							"type":"string",
							"title":"Key"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"if (!binding.hasVariable(\"response\") || !binding.hasVariable(\"key\")){\n  return[:]\n}\n\nreturn [\"schema\": response?.objects?.get(key)?.schema?.schema]",
				"parameters":{
					"key":"{{ 1LOZ8.outputs.result.key }}",
					"response":"{{ PZgsl.outputs.response }}"
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":161,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"RexDI@HOIMK-1@1",
			"id":"TeQ1t",
			"index":0,
			"inputs":{
				"variables":[
					{
						"source":"{{ nkuN3.outputs.schema }}",
						"value":"{{ lmftR.outputs.result.schema }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"branch_condition",
				"resourceVersion":168,
				"resourceName":"branch_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"RexDI@HOIMK-1@2",
			"id":"RexDI@2",
			"index":0,
			"inputs":{
				"name":"getEntityType",
				"conditions":{
					"filters":[
						{
							"property":"{{ 1LOZ8.outputs.result.operationId }}",
							"filter":{
								"operator":"EQUAL",
								"value":"getEntityType"
							}
						}
					],
					"operator":"AND"
				}
			},
			"skip":false,
			"title":"",
			"type":"BRANCH_CONDITION"
		},
		{
			"context":{
				"appName":"standard_entities",
				"resourceVersion":162,
				"resourceName":"standard_entities_get_entity_details",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"RexDI@HOIMK-1@2",
			"id":"TIo2O",
			"index":0,
			"inputs":{
				"schemaType":"OBJECT",
				"entityId":"{{ 1LOZ8.outputs.result.key }}",
				"group":"ENTITY_REPORTING"
			},
			"skip":false,
			"subTitle":"Standard entities by UnifyApps",
			"title":"Get Entity details",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":161,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"RexDI@HOIMK-1@2",
			"id":"6hj7U",
			"index":0,
			"inputs":{
				"variables":[
					{
						"source":"{{ nkuN3.outputs.schema }}",
						"value":"{{ TIo2O.outputs.schema }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":164,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"RexDI@HOIMK-1@default",
			"id":"rjEde",
			"index":0,
			"inputs":{
				"result":{
					"success":false,
					"error":"Fetching dynamic schema is not supported for this tool"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":136,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HOIMK-1",
			"id":"I4rUi",
			"index":0,
			"inputs":{
				"result":{
					"success":true,
					"toolOutput":"{{ nkuN3.outputs.schema }}"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":-1,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":true,
	"tags":[
		"AI Agent",
		"Internal"
	],
	"version":104
}