{
	"appsUsed":[
		"openai"
	],
	"createdTime":1722852112850,
	"deleted":false,
	"deploymentState":{
		"deployedAt":1759243529958,
		"deployedBy":-1,
		"deployedDefinitionId":"68dbed0923e6682b9a51eab8",
		"status":"DEPLOYED",
		"version":23,
		"workflowVersion":59
	},
	"edges":[
		{
			"fromNodeId":"qcOaY",
			"priority":0,
			"skip":false,
			"toNodeId":"n_F9mIb",
			"type":"next"
		},
		{
			"fromNodeId":"n_F9mIb",
			"priority":0,
			"skip":false,
			"toNodeId":"yAkNA",
			"type":"next"
		},
		{
			"fromNodeId":"yAkNA",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"Gbd0l",
			"type":"next"
		},
		{
			"fromNodeId":"Gbd0l",
			"priority":0,
			"skip":false,
			"toNodeId":"en1FC",
			"type":"next"
		},
		{
			"fromNodeId":"en1FC",
			"priority":0,
			"skip":false,
			"toNodeId":"Fcb3x",
			"type":"next"
		},
		{
			"fromNodeId":"yAkNA",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"n_7WYAD",
			"type":"if"
		},
		{
			"fromNodeId":"Fcb3x",
			"priority":0,
			"skip":false,
			"toNodeId":"n_7WYAD",
			"type":"next"
		},
		{
			"fromNodeId":"n_7WYAD",
			"priority":0,
			"skip":false,
			"toNodeId":"Rw09h",
			"type":"next"
		},
		{
			"fromNodeId":"Rw09h",
			"name":"1",
			"priority":0,
			"skip":false,
			"toNodeId":"Rw09h@1",
			"type":"branch"
		},
		{
			"fromNodeId":"Rw09h@1",
			"priority":0,
			"skip":false,
			"toNodeId":"RgOi0",
			"type":"next"
		},
		{
			"fromNodeId":"Rw09h",
			"name":"2",
			"priority":0,
			"skip":false,
			"toNodeId":"Rw09h@2",
			"type":"branch"
		},
		{
			"fromNodeId":"Rw09h@2",
			"priority":0,
			"skip":false,
			"toNodeId":"pIPJQ",
			"type":"next"
		},
		{
			"fromNodeId":"pIPJQ",
			"priority":0,
			"skip":false,
			"toNodeId":"J47KZ",
			"type":"next"
		},
		{
			"fromNodeId":"Rw09h",
			"name":"default",
			"priority":0,
			"skip":false,
			"toNodeId":"_4f41q",
			"type":"branch"
		}
	],
	"grants":{
		"configs":[
			{
				"permissions":[
					"V"
				],
				"principalType":"GLOBAL"
			}
		]
	},
	"id":"66b0a310edae7f274f43b7b4",
	"lastModifiedBy":-1,
	"lcName":"fetch embeddings ",
	"modifiedTime":1759243565005,
	"name":"Fetch Embeddings ",
	"nodes":[
		{
			"context":{
				"appName":"callables",
				"resourceVersion":46,
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"ByODh-1",
			"id":"qcOaY",
			"index":1,
			"inputs":{
				"result":{
					"type":"object",
					"properties":{
						"embeddings":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"Embeddings"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"setup":{
					"type":"object",
					"properties":{
						"userQuery":{
							"type":"string",
							"title":"User Query"
						},
						"aiAgentId":{
							"type":"string",
							"title":"Ai Agent Id"
						}
					},
					"additionalProperties":false,
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger from automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":458,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"ByODh-1",
			"id":"n_F9mIb",
			"index":2,
			"inputs":{
				"automationId":"67a48d37f8f1744841dabb63",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"aiAgentId":"{{ qcOaY.outputs.aiAgentId }}"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":44,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"ByODh-1",
			"id":"yAkNA",
			"index":3,
			"inputs":{
				"filters":[
					{
						"property":"{{ n_F9mIb.outputs.properties.indexingSettings.embeddingModel }}",
						"filter":{
							"operator":"EXISTS"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"TODO",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"custom_http_endpoint",
				"resourceVersion":41,
				"resourceName":"custom_http_endpoint_execute",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"yAkNA@ByODh-1@n",
			"id":"Gbd0l",
			"index":4,
			"inputs":{
				"isAsync":false,
				"enableProxy":false,
				"requestTimeoutInSecs":-1,
				"type":"REST",
				"httpMethod":"POST",
				"body":{
					"payloads":{
						"items":{
							"messages":{
								"items":{
									"blocks":{
										"items":{
											"blockType":"Text",
											"data":{
												"text":"{{ qcOaY.outputs.userQuery }}"
											}
										},
										"ua:type":"mappedArray"
									},
									"role":"user"
								},
								"ua:type":"mappedArray"
							},
							"payloadId":"123"
						},
						"ua:type":"mappedArray"
					}
				},
				"sslVerify":false,
				"path":"/api/v1/nlp/predict",
				"responseSchema":{
					"type":"object",
					"properties":{
						"results":{
							"ua:type":"mappedArray",
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"payloadId":{
										"type":"string",
										"title":"payloadId"
									},
									"messages":{
										"ua:type":"mappedArray",
										"type":"array",
										"items":{
											"type":"object",
											"properties":{
												"role":{
													"type":"string",
													"title":"role"
												},
												"blocks":{
													"ua:type":"mappedArray",
													"type":"array",
													"items":{
														"type":"object",
														"properties":{
															"data":{
																"type":"object",
																"properties":{
																	"vector":{
																		"ua:type":"mappedArray",
																		"type":"array",
																		"items":{
																			"type":"number"
																		},
																		"title":"vector"
																	},
																	"text":{
																		"type":"string",
																		"title":"text"
																	}
																},
																"title":"data",
																"additionalProperties":false
															},
															"blockType":{
																"type":"string",
																"title":"blockType"
															}
														},
														"additionalProperties":false
													},
													"title":"blocks"
												}
											},
											"additionalProperties":false
										},
										"title":"messages"
									},
									"payloadTags":{
										"type":"object",
										"title":"payloadTags"
									}
								},
								"additionalProperties":false
							},
							"title":"results"
						},
						"status":{
							"type":"string",
							"title":"status"
						}
					},
					"additionalProperties":false
				},
				"baseUrl":"https://ai-vectorizer-gte-global.int-alb.qa.unifyapps.com/",
				"bodySchema":{
					"type":"object",
					"properties":{
						"payloads":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"payloadId":{
										"type":"string",
										"title":"payloadId"
									},
									"messages":{
										"type":"array",
										"items":{
											"type":"object",
											"properties":{
												"role":{
													"type":"string",
													"title":"role"
												},
												"blocks":{
													"type":"array",
													"items":{
														"type":"object",
														"properties":{
															"data":{
																"type":"object",
																"properties":{
																	"text":{
																		"type":"string",
																		"title":"text"
																	}
																},
																"title":"data",
																"additionalProperties":false
															},
															"blockType":{
																"type":"string",
																"title":"blockType"
															}
														},
														"additionalProperties":false
													},
													"title":"blocks"
												}
											},
											"additionalProperties":false
										},
										"title":"messages"
									}
								},
								"additionalProperties":false
							},
							"title":"payloads"
						}
					},
					"additionalProperties":false
				},
				"responseContentType":"application/json",
				"authType":"CUSTOM",
				"requestContentType":"application/json",
				"ignoreTrailingSlashes":false
			},
			"skip":false,
			"subTitle":"Custom HTTP Endpoint",
			"title":"Execute request",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.parameters.messages.items"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":43,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"yAkNA@ByODh-1@n",
			"id":"en1FC",
			"index":5,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"embeddings":{
							"type":"array",
							"items":{
								"type":"number"
							},
							"title":"Embeddings"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"messages":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"Messages"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"def result = null\nmessages.each { message ->\n    if (message.role == \"assistant\") {\n        message.blocks.each { block ->\n            if (block.blockType == \"embeddings\") {\n                result = [\"embeddings\": block.data.vector]\n                return result\n            }\n        }\n        if (result != null) {\n            return result\n        }\n    }\n}\nreturn result",
				"parameters":{
					"messages":{
						"ua:type":"mappedArray",
						"source":"{{ Gbd0l.outputs.result.results[0].messages }}",
						"items":"{{ Gbd0l.outputs.result.results[0].messages[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Code By UnifyApps",
			"title":"Execute groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":42,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"yAkNA@ByODh-1@n",
			"id":"Fcb3x",
			"index":6,
			"inputs":{
				"result":{
					"embeddings":{
						"ua:type":"mappedArray",
						"source":"{{ en1FC.outputs.result.embeddings }}",
						"items":"{{ en1FC.outputs.result.embeddings[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":458,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"ByODh-1",
			"id":"n_7WYAD",
			"index":7,
			"inputs":{
				"automationId":"6854195c4a0205327f0f4712",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"modelId":"{{ n_F9mIb.outputs.properties.indexingSettings.embeddingModel }}"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"branch",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"ByODh-1",
			"id":"Rw09h",
			"index":8,
			"inputs":{
				"branches":[
					{
						"id":"1",
						"inputs":{
							"name":"Branch 1",
							"conditions":{
								"filters":[
									{
										"property":"{{ n_7WYAD.outputs.properties.provider }}",
										"filter":{
											"operator":"EQUAL",
											"value":"VOYAGE"
										}
									}
								],
								"operator":"AND"
							}
						}
					},
					{
						"id":"2",
						"inputs":{
							"name":"Branch 2",
							"conditions":{
								"filters":[
									{
										"property":"{{ n_7WYAD.outputs.properties.provider }}",
										"filter":{
											"operator":"EQUAL",
											"value":"OPEN_AI"
										}
									}
								],
								"operator":"AND"
							}
						}
					},
					{
						"id":"default"
					}
				]
			},
			"skip":false,
			"subTitle":"Branch",
			"title":"",
			"type":"BRANCH"
		},
		{
			"context":{
				"appName":"branch_condition",
				"resourceVersion":34,
				"resourceName":"branch_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Rw09h@ByODh-1@1",
			"id":"Rw09h@1",
			"index":9,
			"inputs":{
				"name":"Branch 1",
				"conditions":{
					"filters":[
						{
							"property":"{{ n_7WYAD.outputs.properties.provider }}",
							"filter":{
								"operator":"EQUAL",
								"value":"VOYAGE"
							}
						}
					],
					"operator":"AND"
				}
			},
			"skip":false,
			"title":"",
			"type":"BRANCH_CONDITION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":42,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Rw09h@ByODh-1@1",
			"id":"RgOi0",
			"index":10,
			"inputs":{
				"result":{
					"embeddings":{
						"source":"{{ AQ3ei.outputs.data[0].embedding }}",
						"ua:type":"mappedArray",
						"items":"{{ AQ3ei.outputs.data[0].embedding[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		},
		{
			"context":{
				"appName":"branch_condition",
				"resourceVersion":34,
				"resourceName":"branch_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Rw09h@ByODh-1@2",
			"id":"Rw09h@2",
			"index":11,
			"inputs":{
				"name":"Branch 2",
				"conditions":{
					"filters":[
						{
							"property":"{{ n_7WYAD.outputs.properties.provider }}",
							"filter":{
								"operator":"EQUAL",
								"value":"OPEN_AI"
							}
						}
					],
					"operator":"AND"
				}
			},
			"skip":false,
			"title":"",
			"type":"BRANCH_CONDITION"
		},
		{
			"context":{
				"appName":"openai",
				"resourceVersion":1444,
				"connectionId":"67d50ef9f0655a7378c24507",
				"resourceName":"openai_generate_text_embedding",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Rw09h@ByODh-1@2",
			"id":"pIPJQ",
			"index":12,
			"inputs":{
				"model":"{{ n_7WYAD.outputs.properties.model }}",
				"text":"{{ qcOaY.outputs.userQuery }}",
				"user":"{{ qcOaY.outputs.aiAgentId }}"
			},
			"skip":false,
			"subTitle":"OpenAI",
			"title":"Generate text embedding",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":42,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Rw09h@ByODh-1@2",
			"id":"J47KZ",
			"index":13,
			"inputs":{
				"result":{
					"embeddings":{
						"source":"{{ pIPJQ.outputs.data[0].embedding }}",
						"ua:type":"mappedArray",
						"items":"{{ pIPJQ.outputs.data[0].embedding[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":42,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Rw09h@ByODh-1@default",
			"id":"_4f41q",
			"index":14,
			"inputs":{
				"result":{
					"embeddings":{
						"source":"{{ AQ3ei.outputs.data[0].embedding }}",
						"ua:type":"mappedArray",
						"items":"{{ AQ3ei.outputs.data[0].embedding[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":1866,
	"runtimeConnectionAppNames":[
		"openai"
	],
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"headerValueTierMap":{},
			"tierName":"global"
		}
	},
	"standard":true,
	"tags":[
		"AI Agent"
	],
	"version":60
}