{
	"appsUsed":[
		"prometheus",
		"storage_by_unifyapps"
	],
	"createdTime":1755687462172,
	"deleted":false,
	"deploymentState":{
		"deployedAt":1757352404867,
		"deployedBy":17,
		"deployedDefinitionId":"68bf11d48055366fdd4c31a3",
		"status":"DEPLOYED",
		"version":5,
		"workflowVersion":10
	},
	"edges":[
		{
			"fromNodeId":"n_4R0ZW",
			"priority":0,
			"skip":false,
			"toNodeId":"n_fNfdx",
			"type":"next"
		},
		{
			"fromNodeId":"n_fNfdx",
			"priority":0,
			"skip":false,
			"toNodeId":"n_JmDbY",
			"type":"next"
		},
		{
			"fromNodeId":"n_JmDbY",
			"name":"1",
			"priority":0,
			"skip":false,
			"toNodeId":"n_JmDbY@1",
			"type":"branch"
		},
		{
			"fromNodeId":"n_JmDbY@1",
			"priority":0,
			"skip":false,
			"toNodeId":"n_UEqBg",
			"type":"next"
		},
		{
			"fromNodeId":"n_UEqBg",
			"priority":0,
			"skip":false,
			"toNodeId":"_TFRGn",
			"type":"next"
		},
		{
			"fromNodeId":"_TFRGn",
			"priority":0,
			"skip":false,
			"toNodeId":"_4GASA",
			"type":"next"
		},
		{
			"fromNodeId":"_4GASA",
			"priority":0,
			"skip":false,
			"toNodeId":"n_dELKK",
			"type":"next"
		},
		{
			"fromNodeId":"n_dELKK",
			"priority":0,
			"skip":false,
			"toNodeId":"n_OW4nD",
			"type":"next"
		},
		{
			"fromNodeId":"n_OW4nD",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"_Pc02y",
			"type":"if"
		},
		{
			"fromNodeId":"_Pc02y",
			"priority":0,
			"skip":false,
			"toNodeId":"n_3vxcL",
			"type":"next"
		},
		{
			"fromNodeId":"n_3vxcL",
			"priority":0,
			"skip":false,
			"toNodeId":"_yqz7K",
			"type":"next"
		},
		{
			"fromNodeId":"n_OW4nD",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"n_iJJwu",
			"type":"next"
		},
		{
			"fromNodeId":"_yqz7K",
			"priority":0,
			"skip":false,
			"toNodeId":"n_mZJlI",
			"type":"next"
		},
		{
			"fromNodeId":"n_iJJwu",
			"priority":0,
			"skip":false,
			"toNodeId":"n_mZJlI",
			"type":"next"
		},
		{
			"fromNodeId":"n_JmDbY",
			"name":"2",
			"priority":0,
			"skip":false,
			"toNodeId":"n_JmDbY@2",
			"type":"branch"
		},
		{
			"fromNodeId":"n_JmDbY@2",
			"priority":0,
			"skip":false,
			"toNodeId":"n_FwUXq",
			"type":"next"
		},
		{
			"fromNodeId":"n_FwUXq",
			"priority":0,
			"skip":false,
			"toNodeId":"n_V5DHn",
			"type":"next"
		},
		{
			"fromNodeId":"n_V5DHn",
			"priority":0,
			"skip":false,
			"toNodeId":"n_mzm3N",
			"type":"next"
		},
		{
			"fromNodeId":"n_mzm3N",
			"priority":0,
			"skip":false,
			"toNodeId":"_jv10E",
			"type":"next"
		},
		{
			"fromNodeId":"_jv10E",
			"priority":0,
			"skip":false,
			"toNodeId":"_6ARlo",
			"type":"next"
		},
		{
			"fromNodeId":"_6ARlo",
			"priority":0,
			"skip":false,
			"toNodeId":"n_6CVc9",
			"type":"next"
		},
		{
			"fromNodeId":"n_6CVc9",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"_EZUpg",
			"type":"if"
		},
		{
			"fromNodeId":"_EZUpg",
			"priority":0,
			"skip":false,
			"toNodeId":"_XXe0c",
			"type":"next"
		},
		{
			"fromNodeId":"_XXe0c",
			"priority":0,
			"skip":false,
			"toNodeId":"n_8lTEZ",
			"type":"next"
		},
		{
			"fromNodeId":"n_8lTEZ",
			"priority":0,
			"skip":false,
			"toNodeId":"n_RbjHD",
			"type":"next"
		},
		{
			"fromNodeId":"n_6CVc9",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"n_GJWe2",
			"type":"next"
		},
		{
			"fromNodeId":"n_RbjHD",
			"priority":0,
			"skip":false,
			"toNodeId":"n_gKSdj",
			"type":"next"
		},
		{
			"fromNodeId":"n_GJWe2",
			"priority":0,
			"skip":false,
			"toNodeId":"n_gKSdj",
			"type":"next"
		},
		{
			"fromNodeId":"n_mZJlI",
			"priority":0,
			"skip":false,
			"toNodeId":"n_aFuGU",
			"type":"next"
		},
		{
			"fromNodeId":"n_gKSdj",
			"priority":0,
			"skip":false,
			"toNodeId":"n_aFuGU",
			"type":"next"
		},
		{
			"fromNodeId":"n_JmDbY",
			"name":"default",
			"priority":0,
			"skip":false,
			"toNodeId":"n_aFuGU",
			"type":"branch"
		}
	],
	"id":"68a5aa2641bbec48ac6bd3f6",
	"lastModifiedBy":46030,
	"lcName":"infra | redis | alerts | instance memory usage",
	"modifiedTime":1759219847509,
	"name":"Infra | Redis | Alerts | Instance Memory Usage",
	"nodes":[
		{
			"context":{
				"appName":"callables",
				"resourceVersion":789,
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_kcqOu-1",
			"id":"n_4R0ZW",
			"index":1,
			"inputs":{
				"result":{
					"type":"object",
					"properties":{
						"inputs":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Inputs"
						},
						"outputs":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Outputs"
						},
						"status":{
							"type":"string",
							"title":"Status"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"setup":{
					"type":"object",
					"properties":{
						"baseUrl":{
							"type":"string",
							"title":"Base Url"
						},
						"slackChannel":{
							"type":"string",
							"title":"Slack Channel"
						},
						"memoryLimit":{
							"type":"number",
							"title":"Memory Limit"
						},
						"threshold":{
							"type":"number",
							"title":"Threshold (in percentage)"
						},
						"redisDeploymentType":{
							"type":"string",
							"title":"Redis Deployment Type"
						},
						"env":{
							"type":"string",
							"title":"Env"
						},
						"heartBeatEnv":{
							"type":"string",
							"title":"Heart Beat Env"
						}
					},
					"additionalProperties":false,
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger via automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":117,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_kcqOu-1",
			"id":"n_fNfdx",
			"index":2,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"inputs":{
							"type":"object",
							"properties":{
								"memoryLimit":{
									"type":"integer",
									"title":"memoryLimit"
								},
								"threshold":{
									"type":"integer",
									"title":"threshold"
								}
							},
							"title":"inputs",
							"additionalProperties":false
						},
						"outputs":{
							"type":"object",
							"properties":{
								"memoryUsage":{
									"type":"integer",
									"title":"memoryUsage"
								},
								"memoryUsagePct":{
									"type":"number",
									"title":"memoryUsagePct"
								},
								"message":{
									"type":"string",
									"title":"message"
								},
								"bigkeys":{
									"type":"object",
									"title":"bigkeys"
								}
							},
							"title":"outputs",
							"additionalProperties":false
						},
						"status":{
							"type":"string",
							"title":"status"
						}
					}
				}
			},
			"inputs":{
				"inputs":{
					"threshold":"{{ n_4R0ZW.outputs.threshold }}"
				},
				"status":"OK"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"inputs":{
							"type":"object",
							"properties":{
								"memoryLimit":{
									"type":"integer",
									"title":"memoryLimit"
								},
								"threshold":{
									"type":"integer",
									"title":"threshold"
								}
							},
							"title":"inputs",
							"additionalProperties":false
						},
						"outputs":{
							"type":"object",
							"properties":{
								"memoryUsage":{
									"type":"integer",
									"title":"memoryUsage"
								},
								"memoryUsagePct":{
									"type":"number",
									"title":"memoryUsagePct"
								},
								"message":{
									"type":"string",
									"title":"message"
								},
								"bigkeys":{
									"type":"object",
									"title":"bigkeys"
								}
							},
							"title":"outputs",
							"additionalProperties":false
						},
						"status":{
							"type":"string",
							"title":"status"
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"branch",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_kcqOu-1",
			"id":"n_JmDbY",
			"index":3,
			"inputs":{
				"branches":[
					{
						"id":"1",
						"inputs":{
							"name":"AWS Managed MemoryDB",
							"conditions":{
								"filters":[
									{
										"property":"{{ n_4R0ZW.outputs.redisDeploymentType }}",
										"filter":{
											"operator":"EXISTS"
										}
									},
									{
										"property":"{{ n_4R0ZW.outputs.redisDeploymentType }}",
										"filter":{
											"operator":"EQUAL",
											"value":"AWS_MANAGED_MEMORY_DB"
										}
									}
								],
								"operator":"AND"
							}
						}
					},
					{
						"id":"2",
						"inputs":{
							"name":"Local Redis",
							"conditions":{
								"filters":[
									{
										"property":"{{ n_4R0ZW.outputs.redisDeploymentType }}",
										"filter":{
											"operator":"MISSING"
										}
									},
									{
										"property":"{{ n_4R0ZW.outputs.redisDeploymentType }}",
										"filter":{
											"operator":"EQUAL",
											"value":"LOCAL_REDIS"
										}
									}
								],
								"operator":"OR"
							}
						}
					},
					{
						"id":"default"
					}
				]
			},
			"skip":false,
			"subTitle":"Branch",
			"title":"",
			"type":"BRANCH"
		},
		{
			"context":{
				"appName":"branch_condition",
				"resourceVersion":0,
				"resourceName":"branch_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_JmDbY@_kcqOu-1@1",
			"id":"n_JmDbY@1",
			"index":4,
			"inputs":{
				"name":"AWS Managed MemoryDB",
				"conditions":{
					"filters":[
						{
							"property":"{{ n_4R0ZW.outputs.redisDeploymentType }}",
							"filter":{
								"operator":"EXISTS"
							}
						},
						{
							"property":"{{ n_4R0ZW.outputs.redisDeploymentType }}",
							"filter":{
								"operator":"EQUAL",
								"value":"AWS_MANAGED_MEMORY_DB"
							}
						}
					],
					"operator":"AND"
				}
			},
			"skip":false,
			"title":"",
			"type":"BRANCH_CONDITION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":79,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_JmDbY@_kcqOu-1@1",
			"id":"n_UEqBg",
			"index":5,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"query":{
							"type":"string",
							"title":"Query"
						}
					},
					"required":[]
				}
			},
			"inputs":{},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"query":{
							"type":"string",
							"title":"Query"
						}
					},
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"prometheus",
				"resourceVersion":241,
				"connectionId":"686b62b905711f331a0063dd",
				"resourceName":"prometheus_get_instant_metrics",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_JmDbY@_kcqOu-1@1",
			"id":"_TFRGn",
			"index":6,
			"inputs":{
				"query":"aws_memorydb_bytes_used_for_memory_db_average"
			},
			"skip":false,
			"subTitle":"Used Bytes by Redis",
			"title":"Query instant metrics",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"prometheus",
				"resourceVersion":241,
				"connectionId":"686b62b905711f331a0063dd",
				"resourceName":"prometheus_get_instant_metrics",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_JmDbY@_kcqOu-1@1",
			"id":"_4GASA",
			"index":7,
			"inputs":{
				"query":"aws_memorydb_freeable_memory_average"
			},
			"skip":false,
			"subTitle":"Free Bytes for Redis",
			"title":"Query instant metrics",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":81,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_JmDbY@_kcqOu-1@1",
			"id":"n_dELKK",
			"index":8,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"memoryUsage":{
							"type":"number",
							"title":"Memory Usage"
						},
						"memoryUsagePct":{
							"type":"number",
							"title":"Memory Usage Pct"
						},
						"totalMemory":{
							"type":"number",
							"title":"Total Memory"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"usedBytes":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Used Bytes"
						},
						"freeBytes":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Free Bytes"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"String formatMemory(def bytes) {\n    if (bytes == null) return 0\n    return (bytes / (1024 * 1024 * 1024)).toBigDecimal().setScale(2, BigDecimal.ROUND_HALF_UP)\n}\n\ndef memoryUsage = 0\nif (binding.hasVariable('usedBytes')) {\n  memoryUsage = formatMemory(usedBytes?.value?.get(1)?.toString()?.toBigDecimal())\n}\n\ndef memoryUsagePct = 0\ndef totalMemory = 0\nif (binding.hasVariable('freeBytes')) {\n  def usedMemory = usedBytes?.value?.get(1)?.toString()?.toBigDecimal()\n  totalMemory = usedBytes?.value?.get(1)?.toString()?.toBigDecimal() + freeBytes?.value?.get(1)?.toString()?.toBigDecimal()\n  memoryUsagePct = (usedMemory/totalMemory)*100\n}\n\nreturn [memoryUsage: memoryUsage.toBigDecimal(), memoryUsagePct: memoryUsagePct, totalMemory: totalMemory]",
				"parameters":{
					"usedBytes":"{{ _TFRGn.outputs.data.result[0] }}",
					"freeBytes":"{{ _4GASA.outputs.data.result[0] }}"
				}
			},
			"skip":false,
			"subTitle":"Extract Metrics",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":117,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_JmDbY@_kcqOu-1@1",
			"id":"n_OW4nD",
			"index":9,
			"inputs":{
				"filters":[
					{
						"property":"{{ n_dELKK.outputs.result.memoryUsagePct }}",
						"filter":{
							"operator":"EXISTS"
						}
					},
					{
						"property":"{{ n_dELKK.outputs.result.memoryUsagePct }}",
						"filter":{
							"operator":"GT",
							"value":"{{ n_4R0ZW.outputs.threshold }}"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Is Over Threshold?",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":807,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_OW4nD@n_JmDbY@_kcqOu-1@1@y",
			"id":"_Pc02y",
			"index":10,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"message":{
							"type":"string",
							"title":"Message"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"memoryUsage":{
							"type":"number",
							"title":"Memory Usage"
						},
						"memoryLimit":{
							"type":"number",
							"title":"Memory Limit"
						},
						"threshold":{
							"type":"number",
							"title":"Threshold"
						},
						"memoryUsagePct":{
							"type":"number",
							"title":"Memory Usage Pct"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"def alertMessage = String.format(\n        \"⚠️ High Memory Usage: %.2f%% (Usage: %.2f bytes / Limit: %.2f bytes, Threshold: %.2f%%)\",\n        memoryUsagePct.toBigDecimal(), memoryUsage.toBigDecimal(), memoryLimit.toBigDecimal(), threshold.toBigDecimal()\n    )\n\nreturn [message: alertMessage]",
				"parameters":{
					"threshold":"{{ n_4R0ZW.outputs.threshold }}",
					"memoryUsage":"{{ n_dELKK.outputs.result.memoryUsage }}",
					"memoryLimit":"{{ n_dELKK.outputs.result.totalMemory }}",
					"memoryUsagePct":"{{ n_dELKK.outputs.result.memoryUsagePct }}"
				}
			},
			"skip":false,
			"subTitle":"Generate Alert Message",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":123,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_OW4nD@n_JmDbY@_kcqOu-1@1@y",
			"id":"n_3vxcL",
			"index":11,
			"inputs":{
				"automationId":"68721bd4feea003f6a9cb688",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"env":"{{ n_4R0ZW.outputs.env }}",
					"alertTitle":"Alert | Redis ({{ n_4R0ZW.outputs.env }}) | Instance Memory Usage",
					"alertCategory":"redis",
					"alertType":"instance_memory_usage_check",
					"alertDescription":"{{ _Pc02y.outputs.result.message }}"
				}
			},
			"skip":false,
			"subTitle":"Infra | Capture Heartbeat and Send Alert",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":113,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_OW4nD@n_JmDbY@_kcqOu-1@1@y",
			"id":"_yqz7K",
			"index":12,
			"inputs":{
				"variables":[
					{
						"source":"{{ n_fNfdx.outputs.status }}",
						"value":"CRITICAL"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":118,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_OW4nD@n_JmDbY@_kcqOu-1@1@n",
			"id":"n_iJJwu",
			"index":13,
			"inputs":{
				"variables":[
					{
						"source":"{{ n_fNfdx.outputs.outputs }}",
						"value":{
							"message":"Redis instance does not have high Memory usage."
						}
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":118,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_JmDbY@_kcqOu-1@1",
			"id":"n_mZJlI",
			"index":14,
			"inputs":{
				"variables":[
					{
						"source":"{{ n_fNfdx.outputs.inputs }}",
						"value":{
							"memoryLimit":"{{ n_dELKK.outputs.result.totalMemory }}",
							"threshold":"{{ n_4R0ZW.outputs.threshold }}"
						}
					},
					{
						"source":"{{ n_fNfdx.outputs.outputs }}",
						"value":{
							"memoryUsage":"{{ n_dELKK.outputs.result.memoryUsage }}",
							"memoryUsagePct":"{{ n_dELKK.outputs.result.memoryUsagePct }}"
						}
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"branch_condition",
				"resourceVersion":0,
				"resourceName":"branch_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_JmDbY@_kcqOu-1@2",
			"id":"n_JmDbY@2",
			"index":15,
			"inputs":{
				"name":"Local Redis",
				"conditions":{
					"filters":[
						{
							"property":"{{ n_4R0ZW.outputs.redisDeploymentType }}",
							"filter":{
								"operator":"MISSING"
							}
						},
						{
							"property":"{{ n_4R0ZW.outputs.redisDeploymentType }}",
							"filter":{
								"operator":"EQUAL",
								"value":"LOCAL_REDIS"
							}
						}
					],
					"operator":"OR"
				}
			},
			"skip":false,
			"title":"",
			"type":"BRANCH_CONDITION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":868,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_JmDbY@_kcqOu-1@2",
			"id":"n_FwUXq",
			"index":16,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"namespace":{
							"type":"string",
							"title":"Namespace"
						}
					},
					"required":[]
				}
			},
			"inputs":{
				"namespace":"monitoring"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"namespace":{
							"type":"string",
							"title":"Namespace"
						}
					},
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"custom_http_endpoint",
				"resourceVersion":363,
				"resourceName":"custom_http_endpoint_execute",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_JmDbY@_kcqOu-1@2",
			"id":"n_V5DHn",
			"index":17,
			"inputs":{
				"isAsync":false,
				"enableProxy":false,
				"requestTimeoutInSecs":-1,
				"httpMethod":"POST",
				"connectionType":"DIRECT",
				"sslVerify":false,
				"path":"/internal/infra-tools/list-pods",
				"baseUrl":"{{ n_4R0ZW.outputs.baseUrl }}",
				"queryParamsList":[
					{
						"key":"namespace",
						"value":"{{ n_FwUXq.outputs.namespace }}"
					}
				],
				"responseContentType":"application/json",
				"authType":"CUSTOM",
				"requestContentType":"application/json",
				"ignoreTrailingSlashes":false
			},
			"skip":false,
			"subTitle":"list PODs",
			"title":"Execute REST request",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":806,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_JmDbY@_kcqOu-1@2",
			"id":"n_mzm3N",
			"index":18,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"memoryQuery":{
							"type":"string",
							"title":"Memory Query"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"result":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Result"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"def pod = result?.items?.find { p ->\n    p?.metadata?.labels?.get('app.kubernetes.io/name') == \"prometheus-redis-exporter\"\n}\ndef instance = pod?.spec?.serviceAccount\n\nif (instance == null) {\n  return [:]\n}\n\ndef memoryQuery = \"redis_memory_used_bytes{instance=~\\\"${instance}.monitoring.svc.cluster.local:9121\\\"}\".toString()\n\nreturn [memoryQuery: memoryQuery]",
				"parameters":{
					"result":"{{ n_V5DHn.outputs.result }}"
				}
			},
			"skip":false,
			"subTitle":"Generate Memory Query",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"prometheus",
				"resourceVersion":241,
				"connectionId":"686b62b905711f331a0063dd",
				"resourceName":"prometheus_get_instant_metrics",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_JmDbY@_kcqOu-1@2",
			"id":"_jv10E",
			"index":19,
			"inputs":{
				"query":"{{ n_mzm3N.outputs.result.memoryQuery }}"
			},
			"skip":false,
			"subTitle":"Run Memory Query",
			"title":"Query instant metrics",
			"type":"ACTION"
		},
		{
			"additional":{
				"xsdSchemaConfig":{
					"root":{}
				},
				"visibleOptionalFields":[
					"root.parameters.result.metric.pod",
					"root.parameters.result.values.items"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":803,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_JmDbY@_kcqOu-1@2",
			"id":"_6ARlo",
			"index":20,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"memoryUsage":{
							"type":"number",
							"title":"Memory Usage"
						},
						"memoryUsagePct":{
							"type":"number",
							"title":"Memory Usage Pct"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"memoryResult":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Memory Result",
							"required":[]
						},
						"memoryLimit":{
							"type":"number",
							"title":"Memory Limit"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"def memoryUsage\ndef memoryUsagePct\nif (binding.hasVariable('memoryResult')) {\n  memoryUsage = memoryResult?.value?.get(1)?.toString()?.toLong()\n  memoryUsagePct = (memoryUsage / memoryLimit) * 100\n}\n\nreturn [memoryUsage: memoryUsage, memoryUsagePct: memoryUsagePct]",
				"parameters":{
					"memoryResult":"{{ _jv10E.outputs.data.result[0] }}",
					"memoryLimit":"{{ n_4R0ZW.outputs.memoryLimit }}"
				}
			},
			"skip":false,
			"subTitle":"Extract Memory Usage",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":112,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_JmDbY@_kcqOu-1@2",
			"id":"n_6CVc9",
			"index":21,
			"inputs":{
				"filters":[
					{
						"property":"{{ _6ARlo.outputs.result.memoryUsagePct }}",
						"filter":{
							"operator":"EXISTS"
						}
					},
					{
						"property":"{{ n_4R0ZW.outputs.threshold }}",
						"filter":{
							"operator":"EXISTS"
						}
					},
					{
						"property":"{{ _6ARlo.outputs.result.memoryUsagePct }}",
						"filter":{
							"operator":"GT",
							"value":"{{ n_4R0ZW.outputs.threshold }}"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":807,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_6CVc9@n_JmDbY@_kcqOu-1@2@y",
			"id":"_EZUpg",
			"index":22,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"message":{
							"type":"string",
							"title":"Message"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"memoryUsage":{
							"type":"number",
							"title":"Memory Usage"
						},
						"memoryLimit":{
							"type":"number",
							"title":"Memory Limit"
						},
						"threshold":{
							"type":"number",
							"title":"Threshold"
						},
						"memoryUsagePct":{
							"type":"number",
							"title":"Memory Usage Pct"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"def alertMessage = String.format(\n        \"⚠️ High Memory Usage: %.2f%% (Usage: %.2f bytes / Limit: %.2f bytes, Threshold: %.2f%%)\",\n        memoryUsagePct.toBigDecimal(), memoryUsage.toBigDecimal(), memoryLimit.toBigDecimal(), threshold.toBigDecimal()\n    )\n\nreturn [message: alertMessage]",
				"parameters":{
					"memoryLimit":"{{ n_4R0ZW.outputs.memoryLimit }}",
					"threshold":"{{ n_4R0ZW.outputs.threshold }}",
					"memoryUsage":"{{ _6ARlo.outputs.result.memoryUsage }}",
					"memoryUsagePct":"{{ _6ARlo.outputs.result.memoryUsagePct }}"
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":123,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_6CVc9@n_JmDbY@_kcqOu-1@2@y",
			"id":"_XXe0c",
			"index":23,
			"inputs":{
				"automationId":"68721bd4feea003f6a9cb688",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"env":"{{ n_4R0ZW.outputs.env }}",
					"alertTitle":"Alert | Redis ({{ n_4R0ZW.outputs.env }}) | Instance Memory Usage",
					"alertCategory":"redis",
					"alertType":"instance_memory_usage_check",
					"alertDescription":"{{ _EZUpg.outputs.result.message }}"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":113,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_6CVc9@n_JmDbY@_kcqOu-1@2@y",
			"id":"n_8lTEZ",
			"index":24,
			"inputs":{
				"variables":[
					{
						"source":"{{ n_fNfdx.outputs.status }}",
						"value":"CRITICAL"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":137,
				"resourceName":"storage_by_unifyapps_get_record_by_id",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_6CVc9@n_JmDbY@_kcqOu-1@2@y",
			"id":"n_RbjHD",
			"index":25,
			"inputs":{
				"object_type":"infra_cached_resource",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"translationsOption":"DEFAULT",
				"id":"REDIS_bigkeys",
				"readThroughSessionVariables":false
			},
			"skip":false,
			"subTitle":"Storage by UnifyApps",
			"title":"Fetch record by ID",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":118,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_6CVc9@n_JmDbY@_kcqOu-1@2@n",
			"id":"n_GJWe2",
			"index":26,
			"inputs":{
				"variables":[
					{
						"source":"{{ n_fNfdx.outputs.outputs }}",
						"value":{
							"message":"Redis instance does not have high Memory usage."
						}
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":118,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_JmDbY@_kcqOu-1@2",
			"id":"n_gKSdj",
			"index":27,
			"inputs":{
				"variables":[
					{
						"source":"{{ n_fNfdx.outputs.outputs }}",
						"value":{
							"bigkeys":"{{ n_RbjHD.outputs.properties.resources }}",
							"memoryUsage":"{{ _6ARlo.outputs.result.memoryUsage }}",
							"memoryUsagePct":"{{ _6ARlo.outputs.result.memoryUsagePct }}"
						}
					},
					{
						"source":"{{ n_fNfdx.outputs.inputs }}",
						"value":{
							"memoryLimit":"{{ n_4R0ZW.outputs.memoryLimit }}"
						}
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":800,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_kcqOu-1",
			"id":"n_aFuGU",
			"index":28,
			"inputs":{
				"result":{
					"inputs":"{{ n_fNfdx.outputs.inputs }}",
					"outputs":"{{ n_fNfdx.outputs.outputs }}",
					"status":"{{ n_fNfdx.outputs.status }}"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":46030,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":false,
	"tags":[
		"ua-infra",
		"Infra Tools"
	],
	"version":11
}