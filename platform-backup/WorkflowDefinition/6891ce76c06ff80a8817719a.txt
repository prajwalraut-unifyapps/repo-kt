{
	"appsUsed":[
		"storage_by_unifyapps"
	],
	"createdTime":1758646563823,
	"deleted":false,
	"deploymentState":{
		"deployedAt":1758655385946,
		"deployedBy":0,
		"deployedDefinitionId":"68d2f39938757c179b123b19",
		"status":"DEPLOYED",
		"version":2,
		"workflowVersion":58
	},
	"edges":[
		{
			"fromNodeId":"n_i50FL",
			"priority":0,
			"skip":false,
			"toNodeId":"_N22L9",
			"type":"next"
		},
		{
			"fromNodeId":"_N22L9",
			"priority":0,
			"skip":false,
			"toNodeId":"_UBPJj",
			"type":"next"
		},
		{
			"fromNodeId":"_UBPJj",
			"priority":0,
			"skip":false,
			"toNodeId":"6uxFX",
			"type":"next"
		},
		{
			"fromNodeId":"6uxFX",
			"priority":0,
			"skip":false,
			"toNodeId":"n_wmjPS",
			"type":"next"
		},
		{
			"fromNodeId":"n_wmjPS",
			"priority":0,
			"skip":false,
			"toNodeId":"n_92AQA",
			"type":"next"
		},
		{
			"fromNodeId":"n_92AQA",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"n_HcAOC",
			"type":"if"
		},
		{
			"fromNodeId":"n_HcAOC",
			"priority":0,
			"skip":false,
			"toNodeId":"n_jm6U8",
			"type":"next"
		},
		{
			"fromNodeId":"n_92AQA",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"n_jm6U8",
			"type":"next"
		},
		{
			"fromNodeId":"n_jm6U8",
			"priority":0,
			"skip":false,
			"toNodeId":"n_3j0DS",
			"type":"next"
		},
		{
			"fromNodeId":"n_3j0DS",
			"priority":0,
			"skip":false,
			"toNodeId":"n_ixhCz",
			"type":"next"
		},
		{
			"fromNodeId":"n_ixhCz",
			"priority":0,
			"skip":false,
			"toNodeId":"n_yYeRp",
			"type":"next"
		},
		{
			"fromNodeId":"n_yYeRp",
			"priority":0,
			"skip":false,
			"toNodeId":"n_ZG5aR",
			"type":"next"
		},
		{
			"fromNodeId":"n_ZG5aR",
			"priority":0,
			"skip":false,
			"toNodeId":"yNNAk",
			"type":"next"
		},
		{
			"fromNodeId":"yNNAk",
			"priority":0,
			"skip":false,
			"toNodeId":"n_a9Cj5",
			"type":"next"
		},
		{
			"fromNodeId":"n_a9Cj5",
			"priority":0,
			"skip":false,
			"toNodeId":"n_ewsSW",
			"type":"next"
		},
		{
			"fromNodeId":"n_ewsSW",
			"priority":0,
			"skip":false,
			"toNodeId":"_VG1ro",
			"type":"next"
		},
		{
			"fromNodeId":"_VG1ro",
			"priority":0,
			"skip":false,
			"toNodeId":"_swKzt",
			"type":"next"
		},
		{
			"fromNodeId":"_swKzt",
			"priority":0,
			"skip":false,
			"toNodeId":"n_uin2b",
			"type":"next"
		},
		{
			"fromNodeId":"n_uin2b",
			"priority":0,
			"skip":false,
			"toNodeId":"n_wvdDz",
			"type":"next"
		},
		{
			"fromNodeId":"n_wvdDz",
			"priority":0,
			"skip":false,
			"toNodeId":"4Ssfa",
			"type":"next"
		},
		{
			"fromNodeId":"4Ssfa",
			"priority":0,
			"skip":false,
			"toNodeId":"Ye3ke",
			"type":"next"
		},
		{
			"fromNodeId":"Ye3ke",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"jdaMx",
			"type":"if"
		},
		{
			"fromNodeId":"jdaMx",
			"priority":0,
			"skip":false,
			"toNodeId":"n_U3Ur0",
			"type":"next"
		},
		{
			"fromNodeId":"n_U3Ur0",
			"priority":0,
			"skip":false,
			"toNodeId":"n_gbe4y",
			"type":"next"
		},
		{
			"fromNodeId":"Ye3ke",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"n_gbe4y",
			"type":"next"
		},
		{
			"fromNodeId":"n_gbe4y",
			"priority":0,
			"skip":false,
			"toNodeId":"n_DmkV7",
			"type":"next"
		}
	],
	"grants":{
		"configs":[
			{
				"permissions":[
					"V"
				],
				"principalType":"GLOBAL"
			}
		]
	},
	"id":"6891ce76c06ff80a8817719a",
	"lastModifiedBy":-1,
	"lcName":"deep research tool | plan executor",
	"modifiedTime":1759243567838,
	"name":"Deep Research Tool | Plan Executor",
	"nodes":[
		{
			"context":{
				"appName":"callables",
				"resourceVersion":447,
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"n_i50FL",
			"index":1,
			"inputs":{
				"result":{
					"type":"object",
					"properties":{
						"success":{
							"type":"string",
							"title":"Success"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"setup":{
					"type":"object",
					"properties":{
						"user_query":{
							"type":"string",
							"title":"User Query"
						},
						"research_plan":{
							"type":"string",
							"title":"Research Plan"
						},
						"caseId":{
							"type":"string",
							"title":"Case Id"
						},
						"agentId":{
							"type":"string",
							"title":"Agent Id"
						},
						"modelId":{
							"type":"string",
							"title":"Model Id"
						},
						"draft":{
							"type":"string",
							"title":"Draft"
						},
						"messageId":{
							"type":"string",
							"title":"Message Id"
						}
					},
					"additionalProperties":false,
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger via automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":1,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"_N22L9",
			"index":2,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"filter":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Filter"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"caseId":{
							"type":"string",
							"title":"Case Id"
						},
						"currentAIAgentId":{
							"type":"string",
							"title":"Current AI Agent Id"
						}
					},
					"additionalProperties":false,
					"required":[
						"currentAIAgentId"
					]
				},
				"compile_static":false,
				"code":"def childFilters = []\ndef caseFilter = [\n        field: 'properties.caseId',\n        op: 'IN',\n        values: [caseId]\n    ] \nchildFilters.add(caseFilter) \n\n// if(binding.hasVariable('currentAIAgentId')) {\n// def agentFilter = [\n//     op: 'OR',\n//     values : [\n//         [\n//             field: 'properties.additional.temporaryMessage',\n//             op: 'NOT_EQUAL',\n//             values: [true]\n//         ],\n//         [\n//             op: 'AND',\n//             values:[\n//                 [\n//                     field: 'properties.additional.temporaryMessage',\n//                     op: 'EQUAL',\n//                     values: [true]\n//                 ],\n//                 [\n//                     field: 'properties.fromCustomerUserId',\n//                     op: 'EQUAL',\n//                     values: [currentAIAgentId]\n//                 ]\n//             ]\n//         ]\n//     ]\n// ]\n// childFilters.add(agentFilter)\n// }\n\n\ndef toReturn= [:]\n\ntoReturn << [\"filter\":[\n        op: 'AND',\n        values : childFilters\n    ]]\n\nreturn toReturn\n\n\n// internal messageType != thought || internal messageType == thought & ",
				"isAsync":false,
				"parameters":{
					"caseId":"{{ n_i50FL.outputs.caseId }}",
					"currentAIAgentId":"{{ n_i50FL.outputs.agentId }}"
				}
			},
			"skip":false,
			"subTitle":"prepare filter",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":1817,
				"resourceName":"storage_by_unifyapps_fetch_records",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"_UBPJj",
			"index":3,
			"inputs":{
				"triggerInputCondition":{
					"filters":[
						{
							"property":"properties_caseId",
							"filter":{
								"operator":"EQUAL",
								"value":"{{ n_i50FL.outputs.caseId }}"
							}
						},
						{
							"property":"properties_messageId",
							"filter":{
								"operator":"EQUAL",
								"value":"{{ n_i50FL.outputs.messageId }}"
							}
						}
					],
					"operator":"AND"
				},
				"object_type":"deep_research_qn_a",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"sortBy":[
					{
						"field":"cTm",
						"order":"DESC"
					}
				],
				"translationsOption":"DEFAULT",
				"page":{
					"paginateBy":"OFFSET",
					"limit":2000,
					"offset":0
				},
				"numberOfRecordsToFetch":"MULTIPLE",
				"readThroughSessionVariables":false,
				"includeTotalCount":false
			},
			"skip":false,
			"subTitle":"Messages",
			"title":"Fetch records",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":11,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"6uxFX",
			"index":4,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"sortedMessages":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"properties":{
										"type":"object",
										"properties":{},
										"additionalProperties":false,
										"title":"Properties",
										"required":[]
									},
									"id":{
										"type":"string",
										"title":"Id"
									}
								},
								"additionalProperties":false,
								"required":[
									"properties"
								]
							},
							"title":"Sorted Messages"
						}
					},
					"additionalProperties":false,
					"required":[
						"sortedMessages"
					]
				},
				"input":{
					"type":"object",
					"properties":{
						"messages":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"Messages"
						}
					},
					"additionalProperties":false,
					"required":[
						"messages"
					]
				},
				"compile_static":false,
				"code":"if(!binding.hasVariable('messages')) {\n  return [\"sortedMessages\": []]\n}\nreturn [\"sortedMessages\": messages.sort{it.createdTime}]",
				"parameters":{
					"messages":{
						"ua:type":"mappedArray",
						"source":"{{ _UBPJj.outputs.objects }}",
						"items":"{{ _UBPJj.outputs.objects[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"sort ",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":464,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"n_wmjPS",
			"index":5,
			"inputs":{
				"automationId":"6890ba042a3cad20290ca2d7",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"userQuestion":"{{ n_i50FL.outputs.user_query }}",
					"previousQuesAnswer":{
						"source":"{{ 6uxFX.outputs.result.sortedMessages }}",
						"ua:type":"mappedArray",
						"items":"{{ 6uxFX.outputs.result.sortedMessages[0] }}"
					},
					"evolvingDraft":"{{ n_i50FL.outputs.draft }}",
					"research_plan":"{{ n_i50FL.outputs.research_plan }}"
				}
			},
			"skip":false,
			"subTitle":"Search Query generation",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":439,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"n_92AQA",
			"index":6,
			"inputs":{
				"filters":[
					{
						"property":"{{ n_wmjPS.outputs.research_needed }}",
						"filter":{
							"operator":"EQUAL",
							"value":"false"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":457,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_92AQA@_ggtfG-1@y",
			"id":"n_HcAOC",
			"index":7,
			"inputs":{
				"result":{
					"success":"The research is completed now. No question is left unanswered. "
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":464,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"n_jm6U8",
			"index":8,
			"inputs":{
				"automationId":"6891c27402123667884464db",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"search_query":"{{ n_wmjPS.outputs.searchQuery }}",
					"caseID":"{{ n_i50FL.outputs.caseId }}",
					"agentID":"{{ n_i50FL.outputs.agentId }}",
					"modelID":"{{ n_i50FL.outputs.modelId }}"
				}
			},
			"skip":false,
			"subTitle":"Web call",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"utility_by_unifyapps",
				"resourceVersion":447,
				"resourceName":"utility_by_unifyapps_to_json_string",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"n_3j0DS",
			"index":9,
			"inputs":{
				"object":"{{ n_jm6U8.outputs.res }}"
			},
			"skip":false,
			"subTitle":"Utility by UnifyApps",
			"title":"Serialise object to JSON string",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"template_by_unifyapps",
				"resourceVersion":439,
				"resourceName":"template_by_unifyapps_compile_template",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"n_ixhCz",
			"index":10,
			"inputs":{
				"input_schema":{
					"web_search_content":"{{ n_jm6U8.outputs.res.result }}",
					"query":"{{ n_wmjPS.outputs.searchQuery }}"
				},
				"template_id":"e_68a45be5c701744be3192642"
			},
			"skip":true,
			"subTitle":"Template by UnifyApps",
			"title":"Compile template",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":450,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"n_yYeRp",
			"index":11,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"additionalProperties":false,
									"type":[
										"object",
										"string",
										"number",
										"boolean",
										"integer"
									],
									"properties":{
										"type":{
											"type":"string",
											"title":"Type"
										},
										"text":{
											"type":"string",
											"title":"Text"
										}
									},
									"required":[]
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray",
					"items":{
						"text":"{{ n_ixhCz.outputs.output }}",
						"type":"text"
					}
				},
				"ua:title":"web_summarizer_template",
				"ua:list_type":"OBJECT"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"web_summarizer_template",
							"disableActions":true,
							"items":{
								"type":"object",
								"properties":{
									"type":{
										"type":"string",
										"title":"Type"
									},
									"text":{
										"type":"string",
										"title":"Text"
									}
								},
								"required":[]
							}
						}
					}
				}
			},
			"skip":true,
			"subTitle":"Variable by UnifyApps",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":0,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"n_ZG5aR",
			"index":12,
			"inputs":{
				"automationId":"66ac70650f725f5b425d12d8",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"logProbs":false,
					"aiAgentId":"{{ n_i50FL.outputs.agentId }}",
					"caseId":"{{ n_i50FL.outputs.caseId }}",
					"modelId":"{{ n_i50FL.outputs.modelId }}",
					"message":{
						"items":{
							"content":{
								"source":"{{ n_yYeRp.outputs.items }}",
								"ua:type":"mappedArray",
								"items":"{{ n_yYeRp.outputs.items[0] }}"
							},
							"role":"user"
						},
						"ua:type":"mappedArray"
					}
				}
			},
			"skip":true,
			"subTitle":"Web content summarizer",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"additional":{
				"xsdSchemaConfig":{},
				"visibleOptionalFields":[
					"root.parameters.products.items.category",
					"root.parameters.products.items.productcode",
					"root.parameters.products.items.productspecification",
					"root.parameters.products.items.repuesto",
					"root.parameters.products.items.subcategory",
					"root.parameters.products.items.type",
					"root.parameters.products.items.subtype",
					"root.parameters.products.items.tone",
					"root.parameters.products.items.toneparentproduct"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":79,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"yNNAk",
			"index":13,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"questionId":{
							"type":"string",
							"title":"Question Id"
						}
					}
				},
				"code":"\nreturn [questionId : UUID.randomUUID().toString()]",
				"compile_static":false,
				"captureStdOutput":false,
				"parameters":{}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.record.Answer.items"
				]
			},
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":511,
				"resourceName":"storage_by_unifyapps_create_record",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"n_a9Cj5",
			"index":14,
			"inputs":{
				"writeThroughSessionVariables":false,
				"object_type":"deep_research_qn_a",
				"skipIfBlank":false,
				"record":{
					"caseId":"{{ n_i50FL.outputs.caseId }}",
					"Question":"{{ n_wmjPS.outputs.searchQuery }}",
					"QuestionId":"{{ yNNAk.outputs.result.questionId }}",
					"Answer":"{{ n_3j0DS.outputs.result }}",
					"messageId":"{{ n_i50FL.outputs.messageId }}"
				}
			},
			"skip":false,
			"subTitle":"Storage by UnifyApps",
			"title":"Create record",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":0,
				"resourceName":"storage_by_unifyapps_fetch_records",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"n_ewsSW",
			"index":15,
			"inputs":{
				"triggerInputCondition":{
					"filters":[
						{
							"property":"properties_caseId",
							"filter":{
								"operator":"EQUAL",
								"value":"{{ n_i50FL.outputs.caseId }}"
							}
						},
						{
							"property":"properties_messageId",
							"filter":{
								"operator":"EQUAL",
								"value":"{{ n_i50FL.outputs.messageId }}"
							}
						}
					],
					"operator":"AND"
				},
				"object_type":"draft_ttd_dr",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"translationsOption":"DEFAULT",
				"page":{
					"paginateBy":"OFFSET",
					"limit":20
				},
				"numberOfRecordsToFetch":"SINGLE",
				"readThroughSessionVariables":false,
				"includeTotalCount":false
			},
			"skip":false,
			"subTitle":"Storage by UnifyApps",
			"title":"Fetch records",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":450,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"_VG1ro",
			"index":16,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"type":"object",
									"properties":{
										"type":{
											"type":"string",
											"title":"type"
										},
										"text":{
											"type":"string",
											"title":"text"
										}
									},
									"additionalProperties":false
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray",
					"items":{
						"type":"text",
						"text":"You are a Textual Surgeon. Your role is to perform precise, targeted edits on a document. You do not rewrite or summarize; you locate specific points for revision and update them while preserving the integrity of the surrounding text.\nYour task is to update the Current Draft by finding the exact placeholder that the New Retrieved Information addresses. You must replace only that placeholder with the new information and output the complete, updated draft. Inline citations are mandatory as outlined below.\n\nINPUTS:\nOriginal Query: {{ n_i50FL.outputs.user_query }}\nCurrent Draft: {{ n_ewsSW.outputs.properties.draft }}\nNew Retrieved Information: [Question : {{ n_wmjPS.outputs.searchQuery }}, Answer : {{ n_jm6U8.outputs.res.result }}]. The tool outputs that produced the Answer include chunkIDs. Use the appropriate chunk IDs for inline citations.\n========== TASK INSTRUCTIONS ==========\n\n\nLocate the exact placeholder in the Current Draft that matches the question answered by the New Retrieved Information (e.g., [NEEDS RESEARCH: \"market growth rate\"]). Delete the placeholder tag, and insert—in its exact place—the relevant fact from the Answer.\n\n\nImmediately following the newly inserted information, you must add Inline citation(s) in this exact format:\nFor a single source: $$[1]$$\nFor multiple sources: $$[1,2,3]$$\nCitation numbers must correspond exactly to the chunk IDs from the tool output which are present in the answer provided.\nAlways list all relevant chunk IDs as comma-separated numbers, never as ranges or with skipped numbers.\nPlace the inline citation(s) immediately after the relevant inserted claim, not at the end of the sentence.\nYou must preserve the entire surrounding text and all existing content/citations in the draft; under no circumstances should you alter, omit, or add content except for the exact replacement, the required inline citation(s).\nWhen referencing information, you MUST use inline citations in this exact format:\n\n\nFor single source: \"Information here $$[1]$$\"\nFor multiple sources: \"Information here $$[1,2,3]$$\" Citation numbers are taken from the tool outputs. Place citations directly after the relevant claim.\nInline Citations are MANDATORY for every factual claim derived from the Answer, as well as whenever merging new information with the draft. Always pass all relevant chunk IDs in the inline citation. You must retain all existing inline citations in the Current Draft.\n\n\nOUTPUT ONLY the full, updated draft below. Do NOT include explanations, summaries, headers, or additional notes—only the complete, revised draft as per these instructions.\n\n\n========== EXAMPLES ==========\n\n\nBefore: \"...the industry expanded by approximately [NEEDS RESEARCH: \"official 2024 industry growth percentage\"]...\"\nAfter: \"...the industry expanded by approximately 8.5% $$[1]$$...\"\n\n\nBefore: \"...the initiative launched in [NEEDS RESEARCH: \"launch month and year\"]...\"\nAfter: \"...the initiative launched in March 2024 $$[2,3]$$...\"\n\nReturn only the full, updated draft below."
					}
				},
				"ua:title":"content",
				"ua:list_type":"OBJECT"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"content",
							"disableActions":true,
							"items":{
								"type":"object",
								"properties":{
									"type":{
										"type":"string",
										"title":"type"
									},
									"text":{
										"type":"string",
										"title":"text"
									}
								}
							}
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":464,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"_swKzt",
			"index":17,
			"inputs":{
				"automationId":"66ac70650f725f5b425d12d8",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"aiAgentId":"{{ n_i50FL.outputs.agentId }}",
					"caseId":"{{ n_i50FL.outputs.caseId }}",
					"responseFormat":{
						"type":"text"
					},
					"logProbs":false,
					"message":{
						"items":{
							"role":"user",
							"content":{
								"source":"{{ _VG1ro.outputs.items }}",
								"ua:type":"mappedArray",
								"items":"{{ _VG1ro.outputs.items[0] }}"
							}
						},
						"ua:type":"mappedArray"
					}
				}
			},
			"skip":false,
			"subTitle":"update draft",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":0,
				"resourceName":"storage_by_unifyapps_update_records",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"n_uin2b",
			"index":18,
			"inputs":{
				"numberOfRecordsToUpdate":"SINGLE",
				"triggerInputCondition":{
					"filters":[
						{
							"property":"properties_caseId",
							"filter":{
								"operator":"EQUAL",
								"value":"{{ n_i50FL.outputs.caseId }}"
							}
						},
						{
							"property":"properties_messageId",
							"filter":{
								"operator":"EQUAL",
								"value":"{{ n_i50FL.outputs.messageId }}"
							}
						}
					],
					"operator":"AND"
				},
				"object_type":"draft_ttd_dr",
				"skipIfBlank":false,
				"updateFields":[
					{
						"fieldName":"properties.draft",
						"actionType":"SET",
						"setValue":"{{ _swKzt.outputs.llmResponse }}"
					},
					{
						"fieldName":"properties.numberOfSteps",
						"actionType":"SET",
						"setValue":"=SUM({{ n_ewsSW.outputs.properties.numberOfSteps }},1)"
					}
				],
				"skipIfEmpty":false,
				"page":{
					"offset":0,
					"limit":20
				},
				"unsetIfNull":false
			},
			"skip":false,
			"subTitle":"Storage by UnifyApps",
			"title":"Update records by query",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":523,
				"resourceName":"storage_by_unifyapps_create_record",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"n_wvdDz",
			"index":19,
			"inputs":{
				"writeThroughSessionVariables":false,
				"object_type":"draftSeq",
				"skipIfBlank":false,
				"record":{
					"caseid":"{{ n_a9Cj5.outputs.properties.caseId }}",
					"draft":"{{ _swKzt.outputs.llmResponse }}",
					"Agentid":"{{ n_ewsSW.outputs.properties.agentid }}",
					"steps":"{{ n_ewsSW.outputs.properties.numberOfSteps }}"
				}
			},
			"skip":false,
			"subTitle":"Storage by UnifyApps",
			"title":"Create record",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":532,
				"resourceName":"storage_by_unifyapps_fetch_records",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"4Ssfa",
			"index":20,
			"inputs":{
				"triggerInputCondition":{
					"filters":[
						{
							"property":"properties_caseId",
							"filter":{
								"operator":"EQUAL",
								"value":"{{ n_i50FL.outputs.caseId }}"
							}
						}
					],
					"operator":"AND"
				},
				"object_type":"draft_ttd_dr",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"translationsOption":"DEFAULT",
				"page":{
					"paginateBy":"OFFSET",
					"limit":20
				},
				"numberOfRecordsToFetch":"SINGLE",
				"readThroughSessionVariables":false,
				"includeTotalCount":false
			},
			"skip":false,
			"subTitle":"conv state",
			"title":"Fetch records",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":11,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"Ye3ke",
			"index":21,
			"inputs":{
				"filters":[
					{
						"property":"{{ 4Ssfa.outputs.properties.numberOfSteps }}",
						"filter":{
							"operator":"GTE",
							"value":"2"
						}
					}
				],
				"operator":"OR"
			},
			"skip":false,
			"subTitle":"agent triggered > limit ?",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":79,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Ye3ke@_ggtfG-1@y",
			"id":"jdaMx",
			"index":22,
			"inputs":{
				"automationId":"67b4908aaffe713b4ced2d83",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"completed":true,
					"caseId":"{{ n_i50FL.outputs.caseId }}"
				}
			},
			"skip":true,
			"subTitle":"mark answer as completed",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":457,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Ye3ke@_ggtfG-1@y",
			"id":"n_U3Ur0",
			"index":23,
			"inputs":{
				"result":{
					"success":"ok"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":464,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"n_gbe4y",
			"index":24,
			"inputs":{
				"automationId":"6891f911ad72c510b5dd6eab",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"caseId":"{{ n_i50FL.outputs.caseId }}",
					"task":"{{ n_i50FL.outputs.user_query }}",
					"aiAgentId":"{{ n_i50FL.outputs.agentId }}",
					"instructionsToAppend":"{{ n_i50FL.outputs.research_plan }}",
					"message_ID":"{{ n_i50FL.outputs.messageId }}"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":457,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"_ggtfG-1",
			"id":"n_DmkV7",
			"index":25,
			"inputs":{
				"result":{
					"success":"{{ n_gbe4y.outputs.success }}"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":0,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":true,
	"tags":[
		
	],
	"version":59
}