{
	"appsUsed":[
		"storage_by_unifyapps"
	],
	"createdTime":1737991200223,
	"deleted":false,
	"deploymentState":{
		"deployedAt":1758655412994,
		"deployedBy":0,
		"deployedDefinitionId":"68d2f3b438757c179b123f51",
		"status":"DEPLOYED",
		"version":74,
		"workflowVersion":101
	},
	"edges":[
		{
			"fromNodeId":"QmtDK",
			"priority":0,
			"skip":false,
			"toNodeId":"Aj09f",
			"type":"next"
		},
		{
			"fromNodeId":"Aj09f",
			"priority":0,
			"skip":false,
			"toNodeId":"5ZLAR",
			"type":"next"
		},
		{
			"fromNodeId":"5ZLAR",
			"priority":0,
			"skip":false,
			"toNodeId":"cK9Q0",
			"type":"next"
		},
		{
			"fromNodeId":"cK9Q0",
			"priority":0,
			"skip":false,
			"toNodeId":"5PreK",
			"type":"next"
		},
		{
			"fromNodeId":"5PreK",
			"priority":0,
			"skip":false,
			"toNodeId":"n_KQsS2",
			"type":"next"
		},
		{
			"fromNodeId":"n_KQsS2",
			"priority":0,
			"skip":false,
			"toNodeId":"n_0ansA",
			"type":"next"
		},
		{
			"fromNodeId":"n_0ansA",
			"priority":0,
			"skip":false,
			"toNodeId":"uycsq",
			"type":"next"
		},
		{
			"fromNodeId":"uycsq",
			"priority":0,
			"skip":false,
			"toNodeId":"I3qWM",
			"type":"loop"
		},
		{
			"fromNodeId":"I3qWM",
			"priority":0,
			"skip":false,
			"toNodeId":"iYPOf",
			"type":"next"
		},
		{
			"fromNodeId":"iYPOf",
			"priority":0,
			"skip":false,
			"toNodeId":"Rdysh",
			"type":"loop"
		},
		{
			"fromNodeId":"Rdysh",
			"name":"loopback",
			"priority":0,
			"skip":false,
			"toNodeId":"iYPOf",
			"type":"next"
		},
		{
			"fromNodeId":"iYPOf",
			"priority":0,
			"skip":false,
			"toNodeId":"H4L6N",
			"type":"next"
		},
		{
			"fromNodeId":"H4L6N",
			"name":"loopback",
			"priority":0,
			"skip":false,
			"toNodeId":"uycsq",
			"type":"next"
		},
		{
			"fromNodeId":"uycsq",
			"priority":0,
			"skip":false,
			"toNodeId":"Pn04x",
			"type":"next"
		},
		{
			"fromNodeId":"Pn04x",
			"priority":0,
			"skip":false,
			"toNodeId":"tcLa3",
			"type":"next"
		},
		{
			"fromNodeId":"tcLa3",
			"priority":0,
			"skip":false,
			"toNodeId":"TrgU4",
			"type":"next"
		},
		{
			"fromNodeId":"TrgU4",
			"priority":0,
			"skip":false,
			"toNodeId":"LztVs",
			"type":"next"
		},
		{
			"fromNodeId":"LztVs",
			"priority":0,
			"skip":false,
			"toNodeId":"BITzq",
			"type":"loop"
		},
		{
			"fromNodeId":"BITzq",
			"priority":0,
			"skip":false,
			"toNodeId":"KOo3j",
			"type":"next"
		},
		{
			"fromNodeId":"KOo3j",
			"priority":0,
			"skip":false,
			"toNodeId":"vKDDa",
			"type":"loop"
		},
		{
			"fromNodeId":"vKDDa",
			"priority":0,
			"skip":false,
			"toNodeId":"hPnFp",
			"type":"next"
		},
		{
			"fromNodeId":"hPnFp",
			"name":"loopback",
			"priority":0,
			"skip":false,
			"toNodeId":"KOo3j",
			"type":"next"
		},
		{
			"fromNodeId":"KOo3j",
			"name":"loopback",
			"priority":0,
			"skip":false,
			"toNodeId":"LztVs",
			"type":"next"
		},
		{
			"fromNodeId":"LztVs",
			"priority":0,
			"skip":false,
			"toNodeId":"y9yUX",
			"type":"next"
		},
		{
			"fromNodeId":"y9yUX",
			"priority":0,
			"skip":false,
			"toNodeId":"Hd2t8",
			"type":"next"
		},
		{
			"fromNodeId":"Hd2t8",
			"priority":0,
			"skip":false,
			"toNodeId":"BdxSp",
			"type":"next"
		},
		{
			"fromNodeId":"BdxSp",
			"priority":0,
			"skip":false,
			"toNodeId":"7cwPa",
			"type":"next"
		},
		{
			"fromNodeId":"7cwPa",
			"priority":0,
			"skip":false,
			"toNodeId":"5SVWX",
			"type":"next"
		},
		{
			"fromNodeId":"5SVWX",
			"priority":0,
			"skip":false,
			"toNodeId":"PIwGs",
			"type":"next"
		},
		{
			"fromNodeId":"PIwGs",
			"priority":0,
			"skip":false,
			"toNodeId":"wczCP",
			"type":"next"
		},
		{
			"fromNodeId":"wczCP",
			"priority":0,
			"skip":false,
			"toNodeId":"ROlq3",
			"type":"next"
		},
		{
			"fromNodeId":"ROlq3",
			"priority":0,
			"skip":false,
			"toNodeId":"2LVbQ",
			"type":"next"
		},
		{
			"fromNodeId":"2LVbQ",
			"priority":0,
			"skip":false,
			"toNodeId":"XBxau",
			"type":"next"
		},
		{
			"fromNodeId":"XBxau",
			"priority":0,
			"skip":false,
			"toNodeId":"WZKw8",
			"type":"next"
		},
		{
			"fromNodeId":"WZKw8",
			"priority":0,
			"skip":false,
			"toNodeId":"KlBpP",
			"type":"loop"
		},
		{
			"fromNodeId":"KlBpP",
			"priority":0,
			"skip":false,
			"toNodeId":"KJzrE",
			"type":"next"
		},
		{
			"fromNodeId":"KJzrE",
			"priority":0,
			"skip":false,
			"toNodeId":"40G72",
			"type":"next"
		},
		{
			"fromNodeId":"40G72",
			"priority":0,
			"skip":false,
			"toNodeId":"yeys5",
			"type":"loop"
		},
		{
			"fromNodeId":"yeys5",
			"priority":0,
			"skip":false,
			"toNodeId":"_d8GjX",
			"type":"next"
		},
		{
			"fromNodeId":"_d8GjX",
			"priority":0,
			"skip":false,
			"toNodeId":"gaiE5",
			"type":"next"
		},
		{
			"fromNodeId":"gaiE5",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"UfAmb",
			"type":"if"
		},
		{
			"fromNodeId":"UfAmb",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"yxHBE",
			"type":"if"
		},
		{
			"fromNodeId":"UfAmb",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"ESd6J",
			"type":"next"
		},
		{
			"fromNodeId":"gaiE5",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"xDFBc",
			"type":"next"
		},
		{
			"fromNodeId":"yxHBE",
			"priority":0,
			"skip":false,
			"toNodeId":"n_omQY9",
			"type":"next"
		},
		{
			"fromNodeId":"ESd6J",
			"priority":0,
			"skip":false,
			"toNodeId":"n_omQY9",
			"type":"next"
		},
		{
			"fromNodeId":"xDFBc",
			"priority":0,
			"skip":false,
			"toNodeId":"n_omQY9",
			"type":"next"
		},
		{
			"fromNodeId":"n_omQY9",
			"priority":0,
			"skip":false,
			"toNodeId":"rap89",
			"type":"next"
		},
		{
			"fromNodeId":"rap89",
			"priority":0,
			"skip":false,
			"toNodeId":"FeaQY",
			"type":"next"
		},
		{
			"fromNodeId":"FeaQY",
			"priority":0,
			"skip":false,
			"toNodeId":"FhkHv",
			"type":"next"
		},
		{
			"fromNodeId":"FhkHv",
			"name":"loopback",
			"priority":0,
			"skip":false,
			"toNodeId":"40G72",
			"type":"next"
		},
		{
			"fromNodeId":"40G72",
			"name":"loopback",
			"priority":0,
			"skip":false,
			"toNodeId":"WZKw8",
			"type":"next"
		},
		{
			"fromNodeId":"WZKw8",
			"priority":0,
			"skip":false,
			"toNodeId":"OzPdR",
			"type":"next"
		},
		{
			"fromNodeId":"OzPdR",
			"priority":0,
			"skip":false,
			"toNodeId":"n_Zsu7Y",
			"type":"next"
		},
		{
			"fromNodeId":"n_Zsu7Y",
			"priority":0,
			"skip":false,
			"toNodeId":"R7jDN",
			"type":"next"
		},
		{
			"fromNodeId":"R7jDN",
			"priority":0,
			"skip":false,
			"toNodeId":"5NJGT",
			"type":"loop"
		},
		{
			"fromNodeId":"5NJGT",
			"name":"loopback",
			"priority":0,
			"skip":false,
			"toNodeId":"R7jDN",
			"type":"next"
		},
		{
			"fromNodeId":"R7jDN",
			"priority":0,
			"skip":false,
			"toNodeId":"iZKVu",
			"type":"next"
		}
	],
	"grants":{
		"configs":[
			{
				"permissions":[
					"V"
				],
				"principalType":"GLOBAL"
			}
		]
	},
	"id":"6797a42061665f50fe408f29",
	"lastModifiedBy":-1,
	"lcName":"clustering | entrypoint",
	"modifiedTime":1759243590548,
	"name":"Clustering | EntryPoint",
	"nodes":[
		{
			"additional":{
				"xsdSchemaConfig":{
					"root.result":{}
				}
			},
			"context":{
				"appName":"callables",
				"resourceVersion":202,
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"QmtDK",
			"index":1,
			"inputs":{
				"result":{
					"type":"object",
					"properties":{
						"clusters":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"persistent_cluster_id":{
										"type":"string",
										"title":"persistent_cluster_id"
									},
									"document_id":{
										"type":"string",
										"title":"document_id"
									}
								},
								"additionalProperties":false
							},
							"title":"clusters"
						}
					},
					"additionalProperties":false
				},
				"setup":{
					"type":"object",
					"properties":{
						"client_id":{
							"type":"string",
							"title":"Client Id"
						},
						"document_batch_file":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"document_batch_file"
						}
					},
					"additionalProperties":false,
					"required":[
						"client_id"
					]
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger via automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"utility_by_unifyapps",
				"resourceVersion":5,
				"resourceName":"utility_by_unifyapps_download_file_as_string",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"Aj09f",
			"index":2,
			"inputs":{
				"file":"{{ QmtDK.outputs.document_batch_file }}",
				"encoding":"utf8"
			},
			"skip":false,
			"subTitle":"download cluster file",
			"title":"Download file as string",
			"type":"ACTION"
		},
		{
			"additional":{
				"xsdSchemaConfig":{}
			},
			"context":{
				"appName":"utility_by_unifyapps",
				"resourceVersion":5,
				"resourceName":"utility_by_unifyapps_to_json_object",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"5ZLAR",
			"index":3,
			"inputs":{
				"jsonSchema":{
					"type":"object",
					"properties":{
						"document_batch":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"text":{
										"type":"string",
										"title":"text"
									},
									"document_id":{
										"type":"string",
										"title":"document_id"
									}
								},
								"additionalProperties":false,
								"required":[]
							},
							"title":"Document Batch"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"jsonString":"{{ Aj09f.outputs.fileContent }}"
			},
			"skip":false,
			"subTitle":"deserialise cluster file",
			"title":"Deserialise string to JSON object",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":259,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"cK9Q0",
			"index":4,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"opensearch_k":{
							"type":"integer",
							"title":"Opensearch K"
						},
						"opensearch_threshold":{
							"type":"number",
							"title":"Opensearch Threshold"
						},
						"thread_count":{
							"type":"integer",
							"title":"Thread Count"
						},
						"summaryThreshold":{
							"type":"number",
							"title":"Summary Threshold"
						},
						"embeddingModelId":{
							"type":"string",
							"title":"Embedding Model Id"
						},
						"llmModelId":{
							"type":"string",
							"title":"Llm Model Id"
						}
					},
					"required":[]
				}
			},
			"inputs":{
				"llmModelId":"e_ai_agent_openai_gpt_4.1_nano",
				"opensearch_k":50,
				"opensearch_threshold":0.6,
				"thread_count":25,
				"embeddingModelId":"e_ai_agent_openai_emebedding_3_large",
				"summaryThreshold":0.8
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"opensearch_k":{
							"type":"integer",
							"title":"Opensearch K"
						},
						"opensearch_threshold":{
							"type":"number",
							"title":"Opensearch Threshold"
						},
						"thread_count":{
							"type":"integer",
							"title":"Thread Count"
						},
						"summaryThreshold":{
							"type":"number",
							"title":"Summary Threshold"
						},
						"embeddingModelId":{
							"type":"string",
							"title":"Embedding Model Id"
						},
						"llmModelId":{
							"type":"string",
							"title":"Llm Model Id"
						}
					},
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Hyperparameters",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":205,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"5PreK",
			"index":5,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"objectId":{
							"type":"string",
							"title":"Object Id"
						}
					},
					"additionalProperties":false,
					"required":[
						"objectId"
					]
				},
				"compile_static":false,
				"code":"import org.bson.types.ObjectId\n\nObjectId objectId = new ObjectId()\nString objectIdString = objectId.toString()\n\nreturn [\"objectId\": objectIdString]\n"
			},
			"skip":false,
			"subTitle":"Create Clustering ID",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":464,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"n_KQsS2",
			"index":6,
			"inputs":{
				"automationId":"6784b9216fb83f0972c5625d",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"modelId":"{{ cK9Q0.outputs.embeddingModelId }}",
					"userQuery":"Hello"
				}
			},
			"options":{
				"bulkheadConfig":{
					"enabled":false,
					"global":false
				},
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false,
					"usagePolicy":"ALWAYS"
				},
				"circuitBreakerConfig":{
					"enabled":false,
					"slidingWindowType":"COUNT_BASED"
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false,
					"postHooks":[
						
					],
					"preHooks":[
						
					]
				},
				"logConfig":{
					"enabled":false,
					"logPolicies":[
						
					]
				},
				"rateLimitConfig":{
					"enabled":false,
					"unit":"MINUTES",
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false,
					"metricConfigs":[
						
					]
				}
			},
			"skip":false,
			"subTitle":"Dummy Fetch Embeddings",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":0,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"n_0ansA",
			"index":7,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"embeddingLen":{
							"type":"integer",
							"title":"Embedding Len"
						}
					},
					"required":[]
				}
			},
			"inputs":{
				"embeddingLen":"=LEN({{ n_KQsS2.outputs.embeddings }})"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"embeddingLen":{
							"type":"integer",
							"title":"Embedding Len"
						}
					},
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"loop",
				"resourceVersion":228,
				"resourceName":"loop_for_each",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"uycsq",
			"index":8,
			"inputs":{
				"repeatMode":"BATCH",
				"listSource":"{{ 5ZLAR.outputs.result.document_batch }}",
				"captureIterations":false,
				"batchSize":"={{ cK9Q0.outputs.thread_count }}*8"
			},
			"skip":false,
			"subTitle":"Loop",
			"title":"For loop",
			"type":"LOOP"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":5,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"uycsq@HjLMr-1@l",
			"id":"I3qWM",
			"index":9,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"type":"object",
									"properties":{
										"document_batch":{
											"type":"array",
											"items":{
												"type":"object",
												"properties":{
													"text":{
														"type":"string",
														"title":"text"
													},
													"document_id":{
														"type":"string",
														"title":"document_id"
													}
												},
												"additionalProperties":false
											},
											"title":"document_batch"
										}
									},
									"additionalProperties":false
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray"
				},
				"ua:title":"docs",
				"ua:list_type":"OBJECT"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"docs",
							"disableActions":true,
							"items":{
								"type":"object",
								"properties":{
									"document_batch":{
										"type":"array",
										"items":{
											"type":"object",
											"properties":{
												"text":{
													"type":"string",
													"title":"text"
												},
												"document_id":{
													"type":"string",
													"title":"document_id"
												}
											},
											"additionalProperties":false
										},
										"title":"document_batch"
									}
								}
							}
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"loop",
				"resourceVersion":5,
				"resourceName":"loop_for_each",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"uycsq@HjLMr-1@l",
			"id":"iYPOf",
			"index":10,
			"inputs":{
				"repeatMode":"BATCH",
				"listSource":"{{ uycsq.outputs.item }}",
				"captureIterations":false,
				"batchSize":8
			},
			"skip":false,
			"subTitle":"Loop",
			"title":"For loop",
			"type":"LOOP"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.itemToAdd.document_batch.items.text",
					"root.itemToAdd.document_batch.items.document_id"
				]
			},
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":5,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"iYPOf@uycsq@HjLMr-1@l@l",
			"id":"Rdysh",
			"index":11,
			"inputs":{
				"itemToAdd":{
					"document_batch":{
						"source":"{{ iYPOf.outputs.item }}",
						"ua:type":"mappedArray",
						"items":{
							"text":"{{ iYPOf.outputs.item[0].text }}",
							"document_id":"{{ iYPOf.outputs.item[0].document_id }}"
						}
					}
				},
				"insertLocation":"END",
				"listName":"{{ I3qWM.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":2,
				"resourceName":"callables_call_automation_batch",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"uycsq@HjLMr-1@l",
			"id":"H4L6N",
			"index":12,
			"inputs":{
				"automationId":"679794c43c56e407da9fd5b6",
				"runtimeConnections":{},
				"synchronous":true,
				"distributeWorkflowLoad":false,
				"parametersList":{
					"source":"{{ I3qWM.outputs.items }}",
					"ua:type":"mappedArray",
					"items":{
						"client_id":"{{ QmtDK.outputs.client_id }}",
						"document_batch":{
							"ua:type":"mappedArray",
							"items":{
								"text":"{{ I3qWM.outputs.items[0].document_batch[0].text }}",
								"document_id":"{{ I3qWM.outputs.items[0].document_batch[0].document_id }}"
							},
							"source":"{{ I3qWM.outputs.items[0].document_batch }}"
						},
						"clustering_id":"{{ 5PreK.outputs.result.objectId }}",
						"embeddingModelId":"{{ cK9Q0.outputs.embeddingModelId }}"
					}
				},
				"version":"-1"
			},
			"options":{
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false
				},
				"circuitBreakerConfig":{
					"enabled":false
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false
				},
				"logConfig":{
					"enabled":false
				},
				"rateLimitConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":2.0,
					"captureRetries":false,
					"count":20,
					"enabled":true,
					"initialDelay":1000,
					"maxDelay":5000
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Call automation (batch)",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":261,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"Pn04x",
			"index":13,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"additionalProperties":false,
									"type":[
										"object",
										"string",
										"number",
										"boolean",
										"integer"
									],
									"properties":{}
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray"
				},
				"ua:title":"nodeList",
				"ua:list_type":"STRING"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"nodeList",
							"disableActions":true,
							"items":{
								"type":"string"
							}
						}
					}
				}
			},
			"skip":false,
			"subTitle":"nodeList",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":261,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"tcLa3",
			"index":14,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"additionalProperties":false,
									"type":[
										"object",
										"string",
										"number",
										"boolean",
										"integer"
									],
									"properties":{
										"doc_id":{
											"type":"string",
											"title":"Doc Id"
										},
										"neighbor_id":{
											"type":"string",
											"title":"Neighbor Id"
										},
										"weight":{
											"type":"number",
											"title":"Weight"
										}
									},
									"required":[
										"doc_id",
										"neighbor_id",
										"weight"
									]
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray"
				},
				"ua:title":"edgeList",
				"ua:list_type":"OBJECT"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"edgeList",
							"disableActions":true,
							"items":{
								"type":"object",
								"properties":{
									"doc_id":{
										"type":"string",
										"title":"Doc Id"
									},
									"neighbor_id":{
										"type":"string",
										"title":"Neighbor Id"
									},
									"weight":{
										"type":"number",
										"title":"Weight"
									}
								},
								"required":[
									"doc_id",
									"neighbor_id",
									"weight"
								]
							}
						}
					}
				}
			},
			"skip":false,
			"subTitle":"edgeList",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"delay",
				"resourceVersion":32,
				"resourceName":"delay_for",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"TrgU4",
			"index":15,
			"inputs":{
				"duration":5,
				"unit":"SECONDS"
			},
			"skip":false,
			"subTitle":"Delay for record insertion",
			"title":"Set delay duration",
			"type":"DELAY"
		},
		{
			"context":{
				"appName":"loop",
				"resourceVersion":228,
				"resourceName":"loop_for_each",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"LztVs",
			"index":16,
			"inputs":{
				"repeatMode":"BATCH",
				"listSource":"{{ 5ZLAR.outputs.result.document_batch }}",
				"captureIterations":false,
				"batchSize":"{{ cK9Q0.outputs.thread_count }}"
			},
			"skip":false,
			"subTitle":"document_batch",
			"title":"For loop",
			"type":"LOOP"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":2,
				"resourceName":"callables_call_automation_batch",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"LztVs@HjLMr-1@l",
			"id":"BITzq",
			"index":17,
			"inputs":{
				"automationId":"67a0f02880b7026f265d2d6a",
				"runtimeConnections":{},
				"synchronous":true,
				"distributeWorkflowLoad":false,
				"parametersList":{
					"ua:type":"mappedArray",
					"items":{
						"document_id":"{{ LztVs.outputs.item[0].document_id }}",
						"client_id":"{{ QmtDK.outputs.client_id }}",
						"opensearch_threshold":"{{ cK9Q0.outputs.opensearch_threshold }}",
						"clustering_id":"{{ 5PreK.outputs.result.objectId }}",
						"opensearch_k":"{{ cK9Q0.outputs.opensearch_k }}",
						"embeddingLen":"{{ n_0ansA.outputs.embeddingLen }}"
					},
					"source":"{{ LztVs.outputs.item }}"
				},
				"version":"-1"
			},
			"options":{
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false
				},
				"circuitBreakerConfig":{
					"enabled":false
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false
				},
				"logConfig":{
					"enabled":false
				},
				"rateLimitConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":2.0,
					"captureRetries":false,
					"count":3,
					"enabled":true,
					"initialDelay":1000,
					"maxDelay":2000
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false
				}
			},
			"skip":false,
			"subTitle":"Semantic - Get Nodes and Edges",
			"title":"Call automation (batch)",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"loop",
				"resourceVersion":5,
				"resourceName":"loop_for_each",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"LztVs@HjLMr-1@l",
			"id":"KOo3j",
			"index":18,
			"inputs":{
				"repeatMode":"SINGLE",
				"listSource":"{{ BITzq.outputs.result }}",
				"captureIterations":false
			},
			"skip":false,
			"subTitle":"iterate on result batch",
			"title":"For loop",
			"type":"LOOP"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":5,
				"resourceName":"variable_by_unifyapps_add_items_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"KOo3j@LztVs@HjLMr-1@l@l",
			"id":"vKDDa",
			"index":19,
			"inputs":{
				"insertLocation":"END",
				"itemsToAdd":{
					"ua:type":"mappedArray",
					"source":"{{ KOo3j.outputs.item.nodes }}",
					"items":"{{ KOo3j.outputs.item.nodes[0] }}"
				},
				"listName":"{{ Pn04x.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"add to nodeList",
			"title":"Add items to list",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.itemsToAdd.items.doc_id",
					"root.itemsToAdd.items.neighbor_id",
					"root.itemsToAdd.items.weight"
				]
			},
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":5,
				"resourceName":"variable_by_unifyapps_add_items_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"KOo3j@LztVs@HjLMr-1@l@l",
			"id":"hPnFp",
			"index":20,
			"inputs":{
				"insertLocation":"END",
				"itemsToAdd":{
					"ua:type":"mappedArray",
					"source":"{{ KOo3j.outputs.item.edges }}",
					"items":{
						"doc_id":"{{ KOo3j.outputs.item.edges[0].doc_id }}",
						"neighbor_id":"{{ KOo3j.outputs.item.edges[0].neighbor_id }}",
						"weight":"{{ KOo3j.outputs.item.edges[0].weight }}"
					}
				},
				"listName":"{{ tcLa3.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"add to edgeList",
			"title":"Add items to list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":5,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"y9yUX",
			"index":21,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"graph":{
							"type":"object",
							"properties":{
								"nodes":{
									"type":"array",
									"items":{
										"type":"string"
									},
									"title":"nodes"
								},
								"edges":{
									"type":"array",
									"items":{
										"type":"object",
										"properties":{
											"doc_id":{
												"type":"string",
												"title":"doc_id"
											},
											"neighbor_id":{
												"type":"string",
												"title":"neighbor_id"
											},
											"weight":{
												"type":"number",
												"title":"weight"
											}
										},
										"additionalProperties":false
									},
									"title":"edges"
								}
							},
							"title":"graph",
							"additionalProperties":false
						}
					}
				}
			},
			"inputs":{
				"graph":{
					"nodes":{
						"source":"{{ Pn04x.outputs.items }}",
						"ua:type":"mappedArray",
						"items":"{{ Pn04x.outputs.items[0] }}"
					},
					"edges":{
						"source":"{{ tcLa3.outputs.items }}",
						"ua:type":"mappedArray",
						"items":{
							"doc_id":"{{ tcLa3.outputs.items[0].doc_id }}",
							"neighbor_id":"{{ tcLa3.outputs.items[0].neighbor_id }}",
							"weight":"{{ tcLa3.outputs.items[0].weight }}"
						}
					}
				}
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"graph":{
							"type":"object",
							"properties":{
								"nodes":{
									"type":"array",
									"items":{
										"type":"string"
									},
									"title":"nodes"
								},
								"edges":{
									"type":"array",
									"items":{
										"type":"object",
										"properties":{
											"doc_id":{
												"type":"string",
												"title":"doc_id"
											},
											"neighbor_id":{
												"type":"string",
												"title":"neighbor_id"
											},
											"weight":{
												"type":"number",
												"title":"weight"
											}
										},
										"additionalProperties":false
									},
									"title":"edges"
								}
							},
							"title":"graph",
							"additionalProperties":false
						}
					}
				}
			},
			"skip":false,
			"subTitle":"graph",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"utility_by_unifyapps",
				"resourceVersion":5,
				"resourceName":"utility_by_unifyapps_to_json_string",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"Hd2t8",
			"index":22,
			"inputs":{
				"object":"{{ y9yUX.outputs.graph }}"
			},
			"skip":false,
			"subTitle":"serialize graph",
			"title":"Serialise object to JSON string",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"files_by_unifyapps",
				"resourceVersion":5,
				"resourceName":"files_by_unifyapps_create_temp_file",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"BdxSp",
			"index":23,
			"inputs":{
				"isTmp":true,
				"folderPath":"tmp/shivam",
				"fileName":"test.json",
				"initialContentType":"plainText",
				"type":"SINGLE",
				"fileType":"txt"
			},
			"skip":false,
			"subTitle":"create empty file",
			"title":"Create a file",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"files_by_unifyapps",
				"resourceVersion":5,
				"resourceName":"files_by_unifyapps_append_line_to_file",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"7cwPa",
			"index":24,
			"inputs":{
				"file":"{{ BdxSp.outputs.fileDetails }}",
				"type":"SINGLE",
				"contentType":"plainText",
				"content":"{{ Hd2t8.outputs.result }}"
			},
			"skip":false,
			"subTitle":"add graph to file",
			"title":"Append line(s) to file",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"utility_by_unifyapps",
				"resourceVersion":5,
				"resourceName":"utility_by_unifyapps_generate_public_url",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"5SVWX",
			"index":25,
			"inputs":{
				"file":"{{ BdxSp.outputs.fileDetails }}",
				"expiryTime":1
			},
			"skip":false,
			"subTitle":"generate graph file url",
			"title":"Generate public file URL",
			"type":"ACTION"
		},
		{
			"additional":{
				"xsdSchemaConfig":{
					"root.output":{},
					"root.input":{}
				},
				"visibleOptionalFields":[
					"root.parameters.inputs.nodes.items",
					"root.parameters.inputs.edges.items.doc_id",
					"root.parameters.inputs.edges.items.neighbor_id",
					"root.parameters.inputs.edges.items.weight"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":165,
				"resourceName":"code_by_unifyapps_python",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"PIwGs",
			"index":26,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"cluster_file":{
							"type":"object",
							"properties":{
								"name":{
									"type":"string",
									"title":"name"
								},
								"source":{
									"type":"string",
									"title":"source"
								},
								"sourceType":{
									"type":"string",
									"title":"sourceType"
								},
								"type":{
									"type":"string",
									"title":"type"
								}
							},
							"title":"cluster_file",
							"additionalProperties":false
						}
					},
					"additionalProperties":false
				},
				"configurationMode":"DEFAULT",
				"input":{
					"type":"object",
					"properties":{
						"s3_temp_url":{
							"type":"string",
							"title":"s3_temp_url"
						}
					},
					"additionalProperties":false
				},
				"code":"import community as community_louvain\nimport networkx as nx\nimport boto3\nimport tempfile\nimport os\nfrom urllib.parse import urlparse, unquote\nfrom datetime import datetime\nimport json\n\ns3 = boto3.client(\"s3\")\nparsed_url = urlparse(s3_temp_url)\nbucket_name = parsed_url.path.lstrip('/').split(\"/\")[0]\nfile_key = unquote(\"/\".join(parsed_url.path.lstrip('/').split(\"/\")[1:]))\nfile_name = os.path.basename(file_key).rsplit('.', 1)[0]\ncurrent_datetime = datetime.now().strftime(\"%Y%m%d_%H%M%S\")\nfile_content = \"\"\n\nwith tempfile.NamedTemporaryFile(suffix=\".txt\", delete=True) as temp_file:\n    s3.download_file(Bucket=bucket_name, Key=file_key, Filename=temp_file.name)\n    with open(temp_file.name, \"r\") as f:\n        data = json.loads(f.read().strip(\"\\n\"))\n\nG = nx.Graph()\nG.add_nodes_from(data.get(\"nodes\", []))\n\nfor edge in data.get(\"edges\", []):\n    G.add_edge(edge[\"doc_id\"], edge[\"neighbor_id\"], weight=edge[\"weight\"])\n\npartition = community_louvain.best_partition(G)\npartition_dict = {}\n\nfor i in partition:\n    if partition[i] in partition_dict:\n        partition_dict[partition[i]].append(i)\n    else:\n        partition_dict[partition[i]] = [i]\n\nclusters = []\n\nfor partition_id, doc_ids in partition_dict.items():\n    doc_ids_str = []\n    for doc_id in doc_ids:\n        doc_ids_str.append(doc_id)\n    clusters.append({\n        \"partition_id\": partition_id,\n        \"doc_ids\": doc_ids_str\n    })\n\nclusters = sorted(clusters, key=lambda x: x['partition_id'])\n\ncluster_dict = {\n    \"clusters\": clusters\n}\n\nwith tempfile.NamedTemporaryFile(suffix=\".json\", delete=True) as temp_file:\n    with open(temp_file.name, \"w\") as f:\n        json.dump(cluster_dict, f)\n    basename = os.path.basename(temp_file.name)\n    file_key = f\"clusters/{current_datetime}/{basename}\"\n    s3.upload_file(Filename=temp_file.name, Bucket=bucket_name, Key=file_key)\n    cluster_file = {\n        \"name\": basename,\n        \"source\": file_key,\n        \"sourceType\": \"CLOUD_STORAGE\",\n        \"type\": \"FILE\",\n    }\n\nresult = {\n    \"cluster_file\": cluster_file\n}",
				"isAsync":false,
				"python_version":"3.12",
				"parameters":{
					"s3_temp_url":"{{ 5SVWX.outputs.url }}"
				}
			},
			"options":{
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false
				},
				"circuitBreakerConfig":{
					"enabled":false
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false
				},
				"logConfig":{
					"enabled":false
				},
				"rateLimitConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":2.0,
					"captureRetries":false,
					"count":3,
					"enabled":true,
					"initialDelay":1000,
					"maxDelay":3000
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false
				}
			},
			"skip":false,
			"subTitle":"community_louvain",
			"title":"Execute Python script",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"utility_by_unifyapps",
				"resourceVersion":5,
				"resourceName":"utility_by_unifyapps_download_file_as_string",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"wczCP",
			"index":27,
			"inputs":{
				"file":"{{ PIwGs.outputs.result.cluster_file }}",
				"encoding":"utf8"
			},
			"skip":false,
			"subTitle":"download cluster file",
			"title":"Download file as string",
			"type":"ACTION"
		},
		{
			"additional":{
				"xsdSchemaConfig":{
					"root.jsonSchema":{}
				}
			},
			"context":{
				"appName":"utility_by_unifyapps",
				"resourceVersion":5,
				"resourceName":"utility_by_unifyapps_to_json_object",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"ROlq3",
			"index":28,
			"inputs":{
				"jsonSchema":{
					"type":"object",
					"properties":{
						"clusters":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"partition_id":{
										"type":"integer",
										"title":"partition_id"
									},
									"doc_ids":{
										"type":"array",
										"items":{
											"type":"string"
										},
										"title":"doc_ids"
									}
								},
								"additionalProperties":false,
								"required":[]
							},
							"title":"clusters"
						}
					},
					"additionalProperties":false
				},
				"jsonString":"{{ wczCP.outputs.fileContent }}"
			},
			"skip":false,
			"subTitle":"deserialise cluster file",
			"title":"Deserialise string to JSON object",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":268,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"2LVbQ",
			"index":29,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"additionalProperties":false,
									"type":[
										"object",
										"string",
										"number",
										"boolean",
										"integer"
									],
									"properties":{
										"document_id":{
											"type":"string",
											"title":"Document Id"
										},
										"persistent_cluster_id":{
											"type":"string",
											"title":"Persistent Cluster Id"
										}
									},
									"required":[
										"document_id",
										"persistent_cluster_id"
									]
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray"
				},
				"ua:title":"finalClusters",
				"ua:list_type":"OBJECT"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"finalClusters",
							"disableActions":true,
							"items":{
								"type":"object",
								"properties":{
									"document_id":{
										"type":"string",
										"title":"Document Id"
									},
									"persistent_cluster_id":{
										"type":"string",
										"title":"Persistent Cluster Id"
									}
								},
								"required":[
									"document_id",
									"persistent_cluster_id"
								]
							}
						}
					}
				}
			},
			"skip":false,
			"subTitle":"finalClusters",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":32,
				"resourceName":"variable_by_unifyapps_create_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"XBxau",
			"index":30,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"createList":{
						"ui:title":"",
						"ua:type":{
							"ui:widget":"hidden"
						},
						"items":{
							"ui:title":"Initial list items",
							"ui:description":"Set the initial values of the list (defaults to empty)"
						},
						"ui:order":[
							"*",
							"items"
						]
					},
					"ua:title":{
						"ui:widget":"hidden"
					},
					"ua:list_type":{
						"ui:widget":"hidden"
					}
				},
				"schema":{
					"allOf":[
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"OBJECT"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"items":{
												"type":"object",
												"properties":{}
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"STRING"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of String"
											},
											"items":{
												"type":"string"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"INTEGER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Integers"
											},
											"items":{
												"type":"integer"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"NUMBER"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Numbers"
											},
											"items":{
												"type":"number"
											}
										}
									}
								}
							}
						},
						{
							"if":{
								"properties":{
									"ua:list_type":{
										"const":"BOOLEAN"
									}
								}
							},
							"then":{
								"properties":{
									"createList":{
										"type":"object",
										"properties":{
											"source":{
												"type":"string",
												"format":"ua:source",
												"title":"List of Booleans"
											},
											"items":{
												"type":"boolean"
											}
										}
									}
								}
							}
						}
					],
					"format":"ua:list",
					"type":"object",
					"properties":{
						"ua:title":{
							"type":"string"
						},
						"ua:list_type":{
							"type":"string",
							"title":"List Type",
							"oneOf":[
								{
									"const":"OBJECT",
									"title":"Object"
								},
								{
									"const":"STRING",
									"title":"String"
								},
								{
									"const":"NUMBER",
									"title":"Number"
								},
								{
									"const":"INTEGER",
									"title":"Integer"
								},
								{
									"const":"BOOLEAN",
									"title":"Boolean"
								}
							],
							"default":"OBJECT"
						},
						"createList":{
							"type":"object",
							"properties":{
								"ua:type":{
									"type":"string",
									"default":"mappedArray"
								},
								"source":{
									"type":"string",
									"format":"ua:source",
									"title":"List Item Source"
								},
								"items":{
									"type":"object",
									"properties":{
										"cluster_job_id":{
											"type":"string",
											"title":"cluster_job_id"
										},
										"embeddings":{
											"type":"array",
											"items":{
												"type":"number"
											},
											"title":"embeddings"
										},
										"doc_ids":{
											"type":"array",
											"items":{
												"type":"string"
											},
											"title":"doc_ids"
										},
										"partition_id":{
											"type":"integer",
											"title":"partition_id"
										}
									},
									"additionalProperties":false,
									"required":[]
								}
							}
						}
					}
				}
			},
			"inputs":{
				"createList":{
					"ua:type":"mappedArray"
				},
				"ua:title":"clusters",
				"ua:list_type":"OBJECT"
			},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"type":"object",
					"properties":{
						"items":{
							"type":"array",
							"title":"clusters",
							"disableActions":true,
							"items":{
								"type":"object",
								"properties":{
									"cluster_job_id":{
										"type":"string",
										"title":"cluster_job_id"
									},
									"embeddings":{
										"type":"array",
										"items":{
											"type":"number"
										},
										"title":"embeddings"
									},
									"doc_ids":{
										"type":"array",
										"items":{
											"type":"string"
										},
										"title":"doc_ids"
									},
									"partition_id":{
										"type":"integer",
										"title":"partition_id"
									}
								},
								"required":[]
							}
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Clusters",
			"title":"Create list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"loop",
				"resourceVersion":4,
				"resourceName":"loop_for_each",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"WZKw8",
			"index":31,
			"inputs":{
				"repeatMode":"BATCH",
				"listSource":"{{ ROlq3.outputs.result.clusters }}",
				"captureIterations":false,
				"batchSize":10
			},
			"skip":false,
			"subTitle":"Batched Loop over clusters",
			"title":"For loop",
			"type":"LOOP"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.parameters.clusters.items",
					"root.parameters.allDocsBatch.items"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":32,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"WZKw8@HjLMr-1@l",
			"id":"KlBpP",
			"index":32,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"modifiedClusters":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"doc_texts":{
										"type":"array",
										"items":{
											"type":"string"
										},
										"title":"Doc Texts"
									}
								},
								"additionalProperties":false,
								"required":[
									"doc_texts"
								]
							},
							"title":"Modified Clusters"
						}
					},
					"additionalProperties":false,
					"required":[
						"modifiedClusters"
					]
				},
				"input":{
					"type":"object",
					"properties":{
						"clusters":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"clusters"
						},
						"allDocsBatch":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"allDocsBatch"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"def doc_id_to_msg_map = [:]\nallDocsBatch.each { doc ->\n    doc_id_to_msg_map[doc['document_id']] = doc['text']\n}\n\ndef modifiedClusters = []\nclusters.each { cluster ->\n    def doc_ids = cluster['doc_ids']\n    def doc_texts = []\n    doc_ids.each { doc_id ->\n        doc_texts << doc_id_to_msg_map[doc_id]\n    }\n    modifiedClusters << [\n        'doc_texts': doc_texts\n    ]\n}\n\nreturn [\n    'modifiedClusters': modifiedClusters\n]",
				"parameters":{
					"clusters":{
						"source":"{{ WZKw8.outputs.item }}",
						"ua:type":"mappedArray",
						"items":"{{ WZKw8.outputs.item[0] }}"
					},
					"allDocsBatch":{
						"source":"{{ 5ZLAR.outputs.result.document_batch }}",
						"ua:type":"mappedArray",
						"items":"{{ 5ZLAR.outputs.result.document_batch[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Prepare batch inputs",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":29,
				"resourceName":"callables_call_automation_batch",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"WZKw8@HjLMr-1@l",
			"id":"KJzrE",
			"index":33,
			"inputs":{
				"automationId":"682cd6aba66f2460f7c092f6",
				"runtimeConnections":{},
				"synchronous":true,
				"distributeWorkflowLoad":false,
				"parametersList":{
					"ua:type":"mappedArray",
					"source":"{{ KlBpP.outputs.result.modifiedClusters }}",
					"items":{
						"document_batch":{
							"source":"{{ KlBpP.outputs.result.modifiedClusters[0].doc_texts }}",
							"ua:type":"mappedArray",
							"items":"{{ KlBpP.outputs.result.modifiedClusters[0].doc_texts[0] }}"
						},
						"llmModelId":"{{ cK9Q0.outputs.llmModelId }}",
						"embeddingModelId":"{{ cK9Q0.outputs.embeddingModelId }}"
					}
				},
				"version":"-1"
			},
			"options":{
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false
				},
				"circuitBreakerConfig":{
					"enabled":false
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false
				},
				"logConfig":{
					"enabled":false
				},
				"rateLimitConfig":{
					"duration":"1",
					"enabled":true,
					"threshold":"1000",
					"unit":"MINUTES",
					"waitForNextWindow":true
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false
				}
			},
			"skip":false,
			"subTitle":"Batch Cluster Summary",
			"title":"Call automation (batch)",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"loop",
				"resourceVersion":32,
				"resourceName":"loop_for_each",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"WZKw8@HjLMr-1@l",
			"id":"40G72",
			"index":34,
			"inputs":{
				"repeatMode":"SINGLE",
				"listSource":"{{ KJzrE.outputs.result }}",
				"captureIterations":false
			},
			"skip":false,
			"subTitle":"Loop over cluster embeddings batch",
			"title":"For loop",
			"type":"LOOP"
		},
		{
			"additional":{
				"xsdSchemaConfig":{},
				"visibleOptionalFields":[
					"root.parameters.clusters.items",
					"root.parameters.vector.items"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":32,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"40G72@WZKw8@HjLMr-1@l@l",
			"id":"yeys5",
			"index":35,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"clusterPoint":{
							"type":"object",
							"properties":{
								"partition_id":{
									"type":"integer",
									"title":"partition_id"
								},
								"doc_ids":{
									"type":"array",
									"items":{
										"type":"string"
									},
									"title":"doc_ids"
								}
							},
							"additionalProperties":false,
							"title":"clusterPoint",
							"required":[]
						},
						"embeddingNormalized":{
							"type":"array",
							"items":{
								"type":"number"
							},
							"title":"Embedding Normalized"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"loop_idx":{
							"type":"integer",
							"title":"Loop Idx"
						},
						"clusters":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"clusters"
						},
						"vector":{
							"type":"array",
							"items":{
								"type":"number"
							},
							"title":"Vector"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"def magnitude = Math.sqrt(vector.collect { it * it }.sum())\ndef normalizedVector = vector.collect { it / magnitude }\n\n// Ensure partition_id is integer\ndef clusterPoint = clusters[loop_idx]\nif (clusterPoint.partition_id instanceof String) {\n    clusterPoint.partition_id = clusterPoint.partition_id.toInteger()\n}\n\nreturn [\n  \"clusterPoint\": clusterPoint,\n  \"embeddingNormalized\": normalizedVector\n]",
				"parameters":{
					"loop_idx":"{{ 40G72.outputs.index }}",
					"clusters":{
						"source":"{{ WZKw8.outputs.item }}",
						"ua:type":"mappedArray",
						"items":"{{ WZKw8.outputs.item[0] }}"
					},
					"vector":{
						"source":"{{ 40G72.outputs.item.clusterEmbedding }}",
						"ua:type":"mappedArray",
						"items":"{{ 40G72.outputs.item.clusterEmbedding[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Get current cluster and normalized vector",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"40G72@WZKw8@HjLMr-1@l@l",
			"id":"_d8GjX",
			"index":36,
			"inputs":{
				"automationId":"6891e656cb93f2e6de3537c4",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"clustering_id":"{{ 5PreK.outputs.result.objectId }}",
					"embedding":{
						"source":"{{ yeys5.outputs.result.embeddingNormalized }}",
						"ua:type":"mappedArray",
						"items":"{{ yeys5.outputs.result.embeddingNormalized[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Deduplication with Prefix Cluster",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":32,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"40G72@WZKw8@HjLMr-1@l@l",
			"id":"gaiE5",
			"index":37,
			"inputs":{
				"filters":[
					{
						"property":"{{ _d8GjX.outputs.objects[0].score }}",
						"filter":{
							"operator":"EXISTS"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Score present?",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":32,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"gaiE5@40G72@WZKw8@HjLMr-1@l@l@y",
			"id":"UfAmb",
			"index":38,
			"inputs":{
				"filters":[
					{
						"property":"=IF({{ _d8GjX.outputs.objects[0].score }}>1,{{ _d8GjX.outputs.objects[0].score }}-1,({{ _d8GjX.outputs.objects[0].score }}-1)/{{ _d8GjX.outputs.objects[0].score }})",
						"filter":{
							"operator":"GT",
							"value":"{{ cK9Q0.outputs.summaryThreshold }}"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Score > Threshold?",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.itemToAdd.embeddings.items",
					"root.itemToAdd.doc_ids.items"
				]
			},
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":32,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"UfAmb@gaiE5@40G72@WZKw8@HjLMr-1@l@l@y@y",
			"id":"yxHBE",
			"index":39,
			"inputs":{
				"itemToAdd":{
					"cluster_job_id":"{{ 5PreK.outputs.result.objectId }}",
					"doc_ids":{
						"ua:type":"mappedArray",
						"items":"{{ yeys5.outputs.result.clusterPoint.doc_ids[0] }}",
						"source":"{{ yeys5.outputs.result.clusterPoint.doc_ids }}"
					},
					"embeddings":{
						"source":"{{ yeys5.outputs.result.embeddingNormalized }}",
						"ua:type":"mappedArray",
						"items":"{{ yeys5.outputs.result.embeddingNormalized[0] }}"
					},
					"partition_id":"{{ _d8GjX.outputs.objects[0].partition_id }}"
				},
				"insertLocation":"END",
				"listName":"{{ XBxau.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Update parent partition",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.itemToAdd.embeddings.items",
					"root.itemToAdd.doc_ids.items"
				]
			},
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":32,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"UfAmb@gaiE5@40G72@WZKw8@HjLMr-1@l@l@y@n",
			"id":"ESd6J",
			"index":40,
			"inputs":{
				"itemToAdd":{
					"cluster_job_id":"{{ 5PreK.outputs.result.objectId }}",
					"doc_ids":{
						"ua:type":"mappedArray",
						"items":"{{ yeys5.outputs.result.clusterPoint.doc_ids[0] }}",
						"source":"{{ yeys5.outputs.result.clusterPoint.doc_ids }}"
					},
					"partition_id":"{{ yeys5.outputs.result.clusterPoint.partition_id }}",
					"embeddings":{
						"source":"{{ yeys5.outputs.result.embeddingNormalized }}",
						"ua:type":"mappedArray",
						"items":"{{ yeys5.outputs.result.embeddingNormalized[0] }}"
					}
				},
				"insertLocation":"END",
				"listName":"{{ XBxau.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Keep unchanged",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.itemToAdd.embeddings.items",
					"root.itemToAdd.doc_ids.items"
				]
			},
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":32,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"gaiE5@40G72@WZKw8@HjLMr-1@l@l@n",
			"id":"xDFBc",
			"index":41,
			"inputs":{
				"itemToAdd":{
					"cluster_job_id":"{{ 5PreK.outputs.result.objectId }}",
					"doc_ids":{
						"ua:type":"mappedArray",
						"items":"{{ yeys5.outputs.result.clusterPoint.doc_ids[0] }}",
						"source":"{{ yeys5.outputs.result.clusterPoint.doc_ids }}"
					},
					"partition_id":"{{ yeys5.outputs.result.clusterPoint.partition_id }}",
					"embeddings":{
						"source":"{{ yeys5.outputs.result.embeddingNormalized }}",
						"ua:type":"mappedArray",
						"items":"{{ yeys5.outputs.result.embeddingNormalized[0] }}"
					}
				},
				"insertLocation":"END",
				"listName":"{{ XBxau.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Keep unchanged",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":464,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"40G72@WZKw8@HjLMr-1@l@l",
			"id":"n_omQY9",
			"index":42,
			"inputs":{
				"automationId":"6891e8fa2021321872af7b6e",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"embedding":{
						"source":"{{ 40G72.outputs.item.clusterEmbedding }}",
						"ua:type":"mappedArray",
						"items":"{{ 40G72.outputs.item.clusterEmbedding[0] }}"
					},
					"clustering_id":"{{ 5PreK.outputs.result.objectId }}",
					"partition_id":"{{ yeys5.outputs.result.clusterPoint.partition_id }}"
				}
			},
			"skip":false,
			"subTitle":"Create Record Prefix",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.parameters.dbOutput.items"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":32,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"CONTINUE",
			"groupId":"40G72@WZKw8@HjLMr-1@l@l",
			"id":"rap89",
			"index":43,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"prefixSimilarites":{
							"type":"object",
							"properties":{
								"partitionSimilarities":{
									"type":"array",
									"items":{
										"type":"object",
										"properties":{
											"partition_id":{
												"type":"integer",
												"title":"partition_id"
											},
											"similarity":{
												"type":"number",
												"title":"similarity"
											}
										},
										"additionalProperties":false,
										"required":[]
									},
									"title":"partitionSimilarities"
								}
							},
							"additionalProperties":false
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"dbOutput":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"Db Output"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"if (binding.hasVariable(\"dbOutput\")) {\n    def simpleList = dbOutput.collect { item ->\n        float score = item.score as float\n        float sim_score = (score > 1) ? (score - 1) : ((score - 1) / score)\n        [\n            partition_id: item.document?.partition_id,\n            similarity: sim_score\n        ]\n    }\n    return [ prefixSimilarites: [partitionSimilarities : simpleList] ]\n} else {\n    return [ prefixSimilarites: [:] ]\n}",
				"parameters":{
					"dbOutput":{
						"source":"{{ _d8GjX.outputs.objects }}",
						"ua:type":"mappedArray",
						"items":"{{ _d8GjX.outputs.objects[0] }}"
					}
				}
			},
			"options":{
				"bulkheadConfig":{
					"enabled":false,
					"global":false
				},
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false,
					"usagePolicy":"ALWAYS"
				},
				"circuitBreakerConfig":{
					"enabled":false,
					"slidingWindowType":"COUNT_BASED"
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false,
					"postHooks":[
						
					],
					"preHooks":[
						
					]
				},
				"logConfig":{
					"enabled":false,
					"logPolicies":[
						
					]
				},
				"rateLimitConfig":{
					"enabled":false,
					"unit":"MINUTES",
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"CONTINUE",
				"telemetryConfig":{
					"enableTelemetry":false,
					"metricConfigs":[
						
					]
				}
			},
			"skip":false,
			"subTitle":"[DEBUG] Format similarities",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.record.prefixSimilarites.partitionSimilarities.items.similarity",
					"root.record.prefixSimilarites.partitionSimilarities.items.partition_id"
				]
			},
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":32,
				"resourceName":"storage_by_unifyapps_create_record",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"CONTINUE",
			"groupId":"40G72@WZKw8@HjLMr-1@l@l",
			"id":"FeaQY",
			"index":44,
			"inputs":{
				"writeThroughSessionVariables":false,
				"object_type":"debug_cluster_summary_and_similarities",
				"record":{
					"cluster_job_id":"{{ 5PreK.outputs.result.objectId }}",
					"partition_id":"{{ yeys5.outputs.result.clusterPoint.partition_id }}",
					"clusterSummary":"{{ 40G72.outputs.item.clusterSummary }}",
					"prefixSimilarites":{
						"partitionSimilarities":{
							"source":"{{ rap89.outputs.result.prefixSimilarites.partitionSimilarities }}",
							"ua:type":"mappedArray",
							"items":{
								"similarity":"{{ rap89.outputs.result.prefixSimilarites.partitionSimilarities[0].similarity }}",
								"partition_id":"{{ rap89.outputs.result.prefixSimilarites.partitionSimilarities[0].partition_id }}"
							}
						}
					}
				}
			},
			"options":{
				"bulkheadConfig":{
					"enabled":false,
					"global":false
				},
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false,
					"usagePolicy":"ALWAYS"
				},
				"circuitBreakerConfig":{
					"enabled":false,
					"slidingWindowType":"COUNT_BASED"
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false,
					"postHooks":[
						
					],
					"preHooks":[
						
					]
				},
				"logConfig":{
					"enabled":false,
					"logPolicies":[
						
					]
				},
				"rateLimitConfig":{
					"enabled":false,
					"unit":"MINUTES",
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"CONTINUE",
				"telemetryConfig":{
					"enableTelemetry":false,
					"metricConfigs":[
						
					]
				}
			},
			"skip":false,
			"subTitle":"[DEBUG] Store cluster info",
			"title":"Create record",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"delay",
				"resourceVersion":32,
				"resourceName":"delay_for",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"40G72@WZKw8@HjLMr-1@l@l",
			"id":"FhkHv",
			"index":45,
			"inputs":{
				"duration":2,
				"unit":"SECONDS"
			},
			"skip":false,
			"subTitle":"Delay",
			"title":"Set delay duration",
			"type":"DELAY"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.parameters.clusters.items"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":32,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"OzPdR",
			"index":46,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"processedClusters":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"doc_ids":{
										"type":"array",
										"items":{
											"type":"string"
										},
										"title":"Doc Ids"
									},
									"partition_id":{
										"type":"string",
										"title":"Partition Id"
									},
									"cluster_job_id":{
										"type":"string",
										"title":"Cluster Job Id"
									},
									"embeddings":{
										"type":"array",
										"items":{
											"type":"number"
										},
										"title":"Embeddings"
									}
								},
								"additionalProperties":false,
								"required":[]
							},
							"title":"Processed Clusters"
						}
					},
					"additionalProperties":false,
					"required":[
						"processedClusters"
					]
				},
				"input":{
					"type":"object",
					"properties":{
						"clusters":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"Clusters"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"def mergeClusters(List<Map> clusters) {\n\n    int n = clusters.size()\n\n    Closure<Integer> findParent\n\n    // DSU: Path compression\n    findParent = { int idx ->\n        int parentIdx = clusters[idx]['partition_id']\n        if (parentIdx == idx) {                     // reached root\n            return idx\n        }\n        int root = findParent(parentIdx)            // recurse\n        clusters[idx]['partition_id'] = root  // compress\n        return root\n    }\n\n    /* -----------------------------------------------------------\n       Union step  fold every node into its root cluster\n       ----------------------------------------------------------- */\n    (0..<n).each { i ->\n        int rootIdx = findParent(i)\n        if (rootIdx != i) {                         // not a root\n            def root  = clusters[rootIdx]\n            def child = clusters[i]\n\n            // merge doc_ids\n            root['doc_ids'].addAll(child['doc_ids'])\n            // Nothing to do for embeddings / cluster_job_id /\n            // partition_id  we keep those of the root\n        }\n    }\n\n    /* -----------------------------------------------------------\n       Produce list of unique (root) clusters, dedupe doc_ids (dedup is not needed, but keeping it)\n       ----------------------------------------------------------- */\n    def merged = []\n    (0..<n).each { i ->\n        if ((clusters[i]['partition_id']) == i) {    // is root\n            clusters[i]['doc_ids'] = clusters[i]['doc_ids'].unique()\n            // Explicitly cast partition_id to string here\n            clusters[i]['partition_id'] = clusters[i]['partition_id'].toString()\n            merged << clusters[i]\n        }\n    }\n    return merged\n}\n\ndef mergedClusters = mergeClusters(clusters)\n\nreturn [\n    \"processedClusters\": mergedClusters\n]",
				"parameters":{
					"clusters":{
						"source":"{{ XBxau.outputs.items }}",
						"ua:type":"mappedArray",
						"items":"{{ XBxau.outputs.items[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"DSU: Union Clusters (For de-dup)",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":464,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"n_Zsu7Y",
			"index":47,
			"inputs":{
				"automationId":"6891e9e92021321872af83b4",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"clustering_id":"{{ 5PreK.outputs.result.objectId }}",
					"embeddingLen":"{{ n_0ansA.outputs.embeddingLen }}"
				}
			},
			"skip":false,
			"subTitle":"Delete Record Prefix Cluster",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"loop",
				"resourceVersion":4,
				"resourceName":"loop_for_each",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"R7jDN",
			"index":48,
			"inputs":{
				"repeatMode":"SINGLE",
				"listSource":"{{ OzPdR.outputs.result.processedClusters }}",
				"captureIterations":false
			},
			"skip":false,
			"subTitle":"Loop",
			"title":"For loop",
			"type":"LOOP"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":4,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"R7jDN@HjLMr-1@l",
			"id":"5NJGT",
			"index":49,
			"inputs":{
				"automationId":"67a0f2feb3380723d9e166ff",
				"runtimeConnections":{},
				"synchronous":true,
				"triggerWorkflowWithRuntimeType":"DEFAULT",
				"version":"-1",
				"parameters":{
					"doc_ids":{
						"ua:type":"mappedArray",
						"source":"{{ R7jDN.outputs.item.doc_ids }}",
						"items":"{{ R7jDN.outputs.item.doc_ids[0] }}"
					},
					"client_id":"{{ QmtDK.outputs.client_id }}",
					"opensearch_threshold":"{{ cK9Q0.outputs.opensearch_threshold }}",
					"opensearch_k":"{{ cK9Q0.outputs.opensearch_k }}",
					"clustering_id":"{{ 5PreK.outputs.result.objectId }}",
					"partition_id":"{{ R7jDN.outputs.item.partition_id }}",
					"embeddings":{
						"source":"{{ R7jDN.outputs.item.embeddings }}",
						"ua:type":"mappedArray",
						"items":"{{ R7jDN.outputs.item.embeddings[0] }}"
					},
					"summaryThreshold":"{{ cK9Q0.outputs.summaryThreshold }}",
					"embeddingLen":"{{ n_0ansA.outputs.embeddingLen }}"
				}
			},
			"options":{
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false
				},
				"circuitBreakerConfig":{
					"enabled":false
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false
				},
				"logConfig":{
					"enabled":false
				},
				"rateLimitConfig":{
					"duration":"1",
					"enabled":true,
					"threshold":"1000",
					"unit":"MINUTES",
					"waitForNextWindow":true
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false
				}
			},
			"skip":false,
			"subTitle":"Cluster Deduplication",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":190,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"HjLMr-1",
			"id":"iZKVu",
			"index":50,
			"inputs":{
				"result":{
					"clusters":{
						"source":"{{ 2LVbQ.outputs.items }}",
						"ua:type":"mappedArray",
						"items":{
							"persistent_cluster_id":"{{ 2LVbQ.outputs.items[0].persistent_cluster_id }}",
							"document_id":"{{ 2LVbQ.outputs.items[0].document_id }}"
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":32562,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"nodeLogLevel":"ERROR",
		"route":{
			"default":false,
			"headerValueTierMap":{},
			"tierName":"global"
		}
	},
	"standard":true,
	"tags":[
		"Clustering"
	],
	"version":102
}