{
	"appsUsed":[
		
	],
	"createdTime":1759408882903,
	"deleted":false,
	"edges":[
		{
			"fromNodeId":"_YXJy5",
			"priority":0,
			"skip":false,
			"toNodeId":"n_96ZBq",
			"type":"next"
		},
		{
			"fromNodeId":"n_96ZBq",
			"priority":0,
			"skip":false,
			"toNodeId":"_zNca6",
			"type":"next"
		},
		{
			"fromNodeId":"_zNca6",
			"priority":0,
			"skip":false,
			"toNodeId":"n_ab9zj",
			"type":"next"
		},
		{
			"fromNodeId":"n_ab9zj",
			"priority":0,
			"skip":false,
			"toNodeId":"n_bY8K0",
			"type":"next"
		},
		{
			"fromNodeId":"n_bY8K0",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"n_jqjfO",
			"type":"if"
		},
		{
			"fromNodeId":"n_jqjfO",
			"priority":0,
			"skip":false,
			"toNodeId":"_iwAqH",
			"type":"next"
		},
		{
			"fromNodeId":"n_bY8K0",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"_iwAqH",
			"type":"next"
		}
	],
	"id":"68de72f25b11474238866535",
	"lastModifiedBy":59995,
	"lcName":"buckets number",
	"modifiedTime":1759413674216,
	"name":"Buckets Number",
	"nodes":[
		{
			"context":{
				"appName":"callables",
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":true,
			"fallbackMode":"STOP",
			"groupId":"n_nST1M@n_WOcYr@_jMFmS-1@l@2",
			"id":"_YXJy5",
			"index":1,
			"inputs":{
				"setup":{
					"type":"object",
					"additionalProperties":false,
					"required":[
						"minimumBucketCount"
					],
					"properties":{
						"minimumBucketCount":{
							"type":"integer",
							"title":"Minimum Bucket Count"
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger via automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":3,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":true,
			"fallbackMode":"STOP",
			"groupId":"n_nST1M@n_WOcYr@_jMFmS-1@l@2",
			"id":"n_96ZBq",
			"index":2,
			"inputs":{
				"automationId":"68b932d26607f33c4d7f0988",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{}
			},
			"options":{
				"bulkheadConfig":{
					"enabled":false,
					"global":false
				},
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":true,
					"timeToLive":"3600",
					"usagePolicy":"ALWAYS"
				},
				"circuitBreakerConfig":{
					"enabled":false
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false,
					"postHooks":[
						
					],
					"preHooks":[
						
					]
				},
				"logConfig":{
					"enabled":false,
					"logPolicies":[
						
					]
				},
				"rateLimitConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false,
					"metricConfigs":[
						
					]
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"additional":{
				"xsdSchemaConfig":{
					"root":{}
				}
			},
			"context":{
				"appName":"custom_http_endpoint",
				"resourceVersion":10,
				"resourceName":"custom_http_endpoint_execute",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":true,
			"fallbackMode":"STOP",
			"groupId":"n_nST1M@n_WOcYr@_jMFmS-1@l@2",
			"id":"_zNca6",
			"index":3,
			"inputs":{
				"isAsync":false,
				"enableProxy":false,
				"requestTimeoutInSecs":-1,
				"httpMethod":"POST",
				"body":{
					"sql":"SELECT DB_NAME, TABLE_NAME, PARTITION_NAME, PARTITION_ID, BUCKETS, DISTRIBUTION_KEY, DATA_SIZE FROM information_schema.partitions_meta WHERE BUCKETS < {{ _YXJy5.outputs.minimumBucketCount }};"
				},
				"connectionType":"DIRECT",
				"sslVerify":false,
				"path":"/internal/sql-report/runSQL/query/{{ __RUN__.outputs.customerId }}",
				"responseSchema":{
					"type":"object",
					"additionalProperties":false,
					"properties":{
						"hasMore":{
							"type":"boolean",
							"title":"hasMore"
						},
						"objects":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"DistributionKey":{
										"type":"string",
										"title":"DistributionKey"
									},
									"StorageSize":{
										"type":"string",
										"title":"StorageSize"
									},
									"AvgCS":{
										"type":"string",
										"title":"AvgCS"
									},
									"PartitionId":{
										"type":"string",
										"title":"PartitionId"
									},
									"Range":{
										"type":"string",
										"title":"Range"
									},
									"AsyncWrite":{
										"type":"string",
										"title":"AsyncWrite"
									},
									"Buckets":{
										"type":"string",
										"title":"Buckets"
									},
									"VersionEpoch":{
										"type":"string",
										"title":"VersionEpoch"
									},
									"PartitionName":{
										"type":"string",
										"title":"PartitionName"
									},
									"VersionTxnType":{
										"type":"string",
										"title":"VersionTxnType"
									},
									"State":{
										"type":"string",
										"title":"State"
									},
									"NextVersion":{
										"type":"string",
										"title":"NextVersion"
									},
									"DataSize":{
										"type":"string",
										"title":"DataSize"
									},
									"EnableDataCache":{
										"type":"string",
										"title":"EnableDataCache"
									},
									"PartitionKey":{
										"type":"string",
										"title":"PartitionKey"
									},
									"CompactVersion":{
										"type":"string",
										"title":"CompactVersion"
									},
									"P50CS":{
										"type":"string",
										"title":"P50CS"
									},
									"DataVersion":{
										"type":"string",
										"title":"DataVersion"
									},
									"VisibleVersion":{
										"type":"string",
										"title":"VisibleVersion"
									},
									"RowCount":{
										"type":"string",
										"title":"RowCount"
									},
									"MaxCS":{
										"type":"string",
										"title":"MaxCS"
									}
								},
								"additionalProperties":false
							},
							"title":"objects"
						}
					}
				},
				"baseUrl":"{{ n_96ZBq.outputs.baseInternalUrl }}",
				"httpVersion":"HTTP_2",
				"bodySchema":{
					"type":"object",
					"additionalProperties":false,
					"properties":{
						"sql":{
							"type":"string",
							"title":"sql"
						}
					}
				},
				"queryParamsList":[
					{
						"key":"sqlResourceType",
						"value":"PLATFORM"
					}
				],
				"responseContentType":"application/json",
				"headersList":[],
				"errorResponseSchemas":[],
				"authType":"CUSTOM",
				"requestContentType":"application/json",
				"ignoreTrailingSlashes":false,
				"certificateType":"CERT_STRING"
			},
			"options":{
				"bulkheadConfig":{
					"enabled":false,
					"global":false
				},
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"enabled":false,
					"usagePolicy":"ALWAYS"
				},
				"circuitBreakerConfig":{
					"enabled":false,
					"slidingWindowType":"COUNT_BASED"
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false,
					"postHooks":[
						
					],
					"preHooks":[
						
					]
				},
				"logConfig":{
					"enabled":false,
					"logPolicies":[
						
					]
				},
				"rateLimitConfig":{
					"enabled":false,
					"unit":"MINUTES",
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false,
					"metricConfigs":[
						
					]
				}
			},
			"skip":false,
			"subTitle":"Get Partitions ",
			"title":"Execute REST request",
			"type":"ACTION"
		},
		{
			"additional":{
				"visibleOptionalFields":[
					"root.parameters.tablePartitions.items.DistributionKey",
					"root.parameters.tablePartitions.items.PartitionId",
					"root.parameters.tablePartitions.items.Buckets",
					"root.parameters.tablePartitions.items.PartitionName",
					"root.parameters.tablePartitions.items.State",
					"root.parameters.tablePartitions.items.DataSize",
					"root.parameters.tablePartitions.items.RowCount"
				]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":0,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_nST1M@n_WOcYr@_jMFmS-1@l@2",
			"id":"n_ab9zj",
			"index":4,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"properties":{
						"bucketWarnings":{
							"type":"array",
							"title":"bucketWarnings"
						}
					}
				},
				"input":{
					"type":"object",
					"additionalProperties":false,
					"required":[
						"minBuckets"
					],
					"properties":{
						"tablePartitions":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"DistributionKey":{
										"type":"string",
										"title":"DistributionKey"
									},
									"PartitionId":{
										"type":"string",
										"title":"PartitionId"
									},
									"Buckets":{
										"type":"string",
										"title":"Buckets"
									},
									"PartitionName":{
										"type":"string",
										"title":"PartitionName"
									},
									"State":{
										"type":"string",
										"title":"State"
									},
									"DataSize":{
										"type":"string",
										"title":"DataSize"
									}
								},
								"additionalProperties":false,
								"required":[]
							},
							"title":"tablePartitions"
						},
						"minBuckets":{
							"type":"number",
							"title":"Min Buckets"
						}
					}
				},
				"code":"if (!binding.hasVariable(\"tablePartitions\") || tablePartitions == null) {\n  return [\"bucketWarnings\": []]\n}\n\nbucketWarnings = []\ntablePartitions.each { item -> \n  def bucketNum = Integer.parseInt(item.Buckets ?: \"0\")\n  if (bucketNum < minBuckets) {\n    bucketWarnings << item\n  }\n}\nreturn [\"bucketWarnings\": bucketWarnings]",
				"compile_static":false,
				"captureStdOutput":false,
				"parameters":{
					"minBuckets":"{{ _auxBn.outputs.result.minimumBucketCount }}",
					"tablePartitions":{
						"source":"{{ _zNca6.outputs.result.objects }}",
						"ua:type":"mappedArray",
						"items":{
							"DistributionKey":"{{ _zNca6.outputs.result.objects[0].DistributionKey }}",
							"PartitionId":"{{ _zNca6.outputs.result.objects[0].PartitionId }}",
							"Buckets":"{{ _zNca6.outputs.result.objects[0].Buckets }}",
							"PartitionName":"{{ _zNca6.outputs.result.objects[0].PartitionName }}",
							"State":"{{ _zNca6.outputs.result.objects[0].State }}",
							"DataSize":"{{ _zNca6.outputs.result.objects[0].DataSize }}"
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":2,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_nST1M@n_WOcYr@_jMFmS-1@l@2",
			"id":"n_bY8K0",
			"index":5,
			"inputs":{
				"filters":[
					{
						"property":"=LEN({{ n_ab9zj.outputs.result.bucketWarnings }})",
						"filter":{
							"operator":"GT",
							"value":"0"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":2,
				"resourceName":"variable_by_unifyapps_add_item_to_list",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_bY8K0@n_nST1M@n_WOcYr@_jMFmS-1@l@2@y",
			"id":"n_jqjfO",
			"index":6,
			"inputs":{
				"itemToAdd":{
					"dbName":"{{ n_WOcYr.outputs.item.DbName }}",
					"tableName":"{{ n_WOcYr.outputs.item.TableName }}",
					"routineLoadName":"{{ n_WOcYr.outputs.item.Name }}",
					"buckets":{
						"source":"{{ n_ab9zj.outputs.result.bucketWarnings }}",
						"ua:type":"mappedArray",
						"items":"{{ n_ab9zj.outputs.result.bucketWarnings }}"
					}
				},
				"insertLocation":"END",
				"listName":"{{ n_CWqg9.outputs.items[0] }}"
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Add item to list",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"n_nST1M@n_WOcYr@_jMFmS-1@l@2",
			"id":"_iwAqH",
			"index":7,
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":59995,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":false,
	"tags":[
		
	],
	"version":1
}