{
	"appsUsed":[
		"storage_by_unifyapps"
	],
	"createdTime":1722934897520,
	"deleted":false,
	"deploymentState":{
		"deployedAt":1759243560146,
		"deployedBy":-1,
		"deployedDefinitionId":"68dbed285e003e08cdeb2f08",
		"status":"DEPLOYED",
		"version":85,
		"workflowVersion":137
	},
	"edges":[
		{
			"fromNodeId":"Jaq7M",
			"priority":0,
			"skip":false,
			"toNodeId":"5BsUt",
			"type":"next"
		},
		{
			"fromNodeId":"5BsUt",
			"priority":0,
			"skip":false,
			"toNodeId":"n_cAeOK",
			"type":"next"
		},
		{
			"fromNodeId":"n_cAeOK",
			"priority":0,
			"skip":false,
			"toNodeId":"rt5uA",
			"type":"next"
		},
		{
			"fromNodeId":"rt5uA",
			"priority":0,
			"skip":false,
			"toNodeId":"ygj8N",
			"type":"next"
		},
		{
			"fromNodeId":"ygj8N",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"N4SO3",
			"type":"next"
		},
		{
			"fromNodeId":"N4SO3",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"zwa3r",
			"type":"if"
		},
		{
			"fromNodeId":"ygj8N",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"SE7zm",
			"type":"if"
		},
		{
			"fromNodeId":"zwa3r",
			"priority":0,
			"skip":false,
			"toNodeId":"SE7zm",
			"type":"next"
		},
		{
			"fromNodeId":"N4SO3",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"SE7zm",
			"type":"next"
		},
		{
			"fromNodeId":"SE7zm",
			"priority":0,
			"skip":false,
			"toNodeId":"Hjcdr",
			"type":"next"
		},
		{
			"fromNodeId":"Hjcdr",
			"priority":0,
			"skip":false,
			"toNodeId":"eo2AH",
			"type":"next"
		},
		{
			"fromNodeId":"eo2AH",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"ke5VS",
			"type":"if"
		},
		{
			"fromNodeId":"ke5VS",
			"priority":0,
			"skip":false,
			"toNodeId":"sxzCa",
			"type":"next"
		},
		{
			"fromNodeId":"sxzCa",
			"priority":0,
			"skip":false,
			"toNodeId":"gm2Iu",
			"type":"next"
		},
		{
			"fromNodeId":"eo2AH",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"W8Dqj",
			"type":"next"
		},
		{
			"fromNodeId":"W8Dqj",
			"priority":0,
			"skip":false,
			"toNodeId":"YZhki",
			"type":"next"
		},
		{
			"fromNodeId":"YZhki",
			"name":"yes",
			"priority":0,
			"skip":false,
			"toNodeId":"n_PtC25",
			"type":"if"
		},
		{
			"fromNodeId":"n_PtC25",
			"priority":0,
			"skip":false,
			"toNodeId":"Eyd9E",
			"type":"next"
		},
		{
			"fromNodeId":"Eyd9E",
			"priority":0,
			"skip":false,
			"toNodeId":"r7Eia",
			"type":"next"
		},
		{
			"fromNodeId":"YZhki",
			"name":"no",
			"priority":0,
			"skip":false,
			"toNodeId":"xBuBA",
			"type":"next"
		},
		{
			"fromNodeId":"xBuBA",
			"priority":0,
			"skip":false,
			"toNodeId":"CvoWv",
			"type":"next"
		},
		{
			"fromNodeId":"gm2Iu",
			"priority":0,
			"skip":false,
			"toNodeId":"Acxdd",
			"type":"next"
		},
		{
			"fromNodeId":"r7Eia",
			"priority":0,
			"skip":false,
			"toNodeId":"Acxdd",
			"type":"next"
		},
		{
			"fromNodeId":"CvoWv",
			"priority":0,
			"skip":false,
			"toNodeId":"Acxdd",
			"type":"next"
		},
		{
			"fromNodeId":"Acxdd",
			"priority":0,
			"skip":false,
			"toNodeId":"wW9pI",
			"type":"next"
		},
		{
			"fromNodeId":"wW9pI",
			"priority":0,
			"skip":false,
			"toNodeId":"rmKs1",
			"type":"next"
		},
		{
			"fromNodeId":"rmKs1",
			"priority":0,
			"skip":false,
			"toNodeId":"6adYg",
			"type":"next"
		},
		{
			"fromNodeId":"6adYg",
			"priority":0,
			"skip":false,
			"toNodeId":"TkX7e",
			"type":"next"
		},
		{
			"fromNodeId":"TkX7e",
			"priority":0,
			"skip":false,
			"toNodeId":"n7cL3",
			"type":"next"
		},
		{
			"fromNodeId":"n7cL3",
			"priority":0,
			"skip":false,
			"toNodeId":"UxfaO",
			"type":"next"
		}
	],
	"grants":{
		"configs":[
			{
				"permissions":[
					"V"
				],
				"principalType":"GLOBAL"
			}
		]
	},
	"id":"66b1e6711f7c5a2ce6bd2baf",
	"lastModifiedBy":-1,
	"lcName":"query rephraser (ai agent)",
	"modifiedTime":1759371881939,
	"name":"Query Rephraser (AI Agent)",
	"nodes":[
		{
			"context":{
				"appName":"callables",
				"resourceVersion":46,
				"resourceName":"callables_from_automation"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Fheb4-1",
			"id":"Jaq7M",
			"index":1,
			"inputs":{
				"result":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"rephrased_user_message":{
							"type":"string",
							"title":"rephrased_user_message"
						},
						"reply":{
							"type":"string",
							"title":"reply"
						},
						"chit_chat":{
							"type":"string",
							"title":"chit_chat"
						},
						"retry_with_context":{
							"type":"boolean",
							"title":"retry_with_context"
						}
					}
				},
				"setup":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"messageHistory":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{
									"role":{
										"type":"string",
										"title":"role"
									},
									"content":{
										"type":"string",
										"title":"content"
									}
								},
								"additionalProperties":false
							},
							"title":"messageHistory"
						},
						"userQuery":{
							"type":"string",
							"title":"userQuery"
						},
						"aiAgentId":{
							"type":"string",
							"title":"Ai Agent Id"
						}
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Trigger from automation",
			"trigger":{
				"type":"CALLABLE"
			},
			"type":"START"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":139,
				"resourceName":"variable_by_unifyapps_get_session_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Fheb4-1",
			"id":"5BsUt",
			"index":2,
			"inputs":{
				"variableSchema":{
					"type":"object",
					"properties":{
						"caseId":{
							"type":"string",
							"title":"Case Id"
						},
						"messageId":{
							"type":"string",
							"title":"Message Id"
						}
					},
					"additionalProperties":false,
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Get Session Variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":458,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Fheb4-1",
			"id":"n_cAeOK",
			"index":3,
			"inputs":{
				"automationId":"67a48d37f8f1744841dabb63",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"aiAgentId":"{{ Jaq7M.outputs.aiAgentId }}"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":19,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Fheb4-1",
			"id":"rt5uA",
			"index":4,
			"inputs":{
				"automationId":"679b33676b66b84f25410633",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"aiAgentId":"{{ Jaq7M.outputs.aiAgentId }}"
				}
			},
			"options":{
				"businessHoursConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"cacheConfig":{
					"cacheKey":"{{ vBzOH.outputs.aiAgentId }}",
					"enabled":false,
					"timeToLive":"3600"
				},
				"circuitBreakerConfig":{
					"enabled":false
				},
				"disableLogging":false,
				"enabledForReExecution":false,
				"hookConfig":{
					"enabled":false
				},
				"logConfig":{
					"enabled":false
				},
				"rateLimitConfig":{
					"enabled":false,
					"waitForNextWindow":false
				},
				"retryConfig":{
					"backOffFactor":null,
					"captureRetries":false,
					"enabled":false
				},
				"stepError":"STOP",
				"telemetryConfig":{
					"enableTelemetry":false
				}
			},
			"skip":false,
			"subTitle":"agentExecutor Enabled",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":341,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Fheb4-1",
			"id":"ygj8N",
			"index":5,
			"inputs":{
				"filters":[
					{
						"property":"{{ n_cAeOK.outputs.properties.preProcessingSettings.disableRephraser }}",
						"filter":{
							"operator":"EQUAL",
							"value":"false"
						}
					},
					{
						"property":"{{ Jaq7M.outputs.aiAgentId }}",
						"filter":{
							"operator":"EQUAL",
							"value":"enterprise_search_agent"
						}
					}
				],
				"operator":"OR"
			},
			"skip":false,
			"subTitle":"enableRephraser",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":71,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"ygj8N@Fheb4-1@n",
			"id":"N4SO3",
			"index":6,
			"inputs":{
				"filters":[
					{
						"property":"{{ n_cAeOK.outputs.properties.preProcessingSettings.disableRephraser }}",
						"filter":{
							"operator":"EQUAL",
							"value":"true"
						}
					},
					{
						"property":"{{ rt5uA.outputs.agentExecutorEnabled }}",
						"filter":{
							"operator":"EQUAL",
							"value":"true"
						}
					}
				],
				"operator":"OR"
			},
			"skip":false,
			"subTitle":"Disable rephraser?",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":73,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"N4SO3@ygj8N@Fheb4-1@n@y",
			"id":"zwa3r",
			"index":7,
			"inputs":{
				"result":{
					"rephrased_user_message":"{{ Jaq7M.outputs.userQuery }}",
					"chit_chat":"false"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		},
		{
			"context":{
				"appName":"storage_by_unifyapps",
				"resourceVersion":1636,
				"resourceName":"storage_by_unifyapps_fetch_records",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Fheb4-1",
			"id":"SE7zm",
			"index":8,
			"inputs":{
				"triggerInputCondition":{
					"filters":[
						{
							"property":"properties_type",
							"filter":{
								"operator":"EQUAL",
								"value":"REPHRASER"
							}
						},
						{
							"property":"properties_aiAgentId",
							"filter":{
								"operator":"EQUAL",
								"value":"{{ Jaq7M.outputs.aiAgentId }}"
							}
						}
					],
					"operator":"AND"
				},
				"object_type":"prompt",
				"includeRoleMappings":false,
				"includeCurrentUserPermissions":false,
				"translationsOption":"DEFAULT",
				"page":{
					"limit":20,
					"offset":0
				},
				"numberOfRecordsToFetch":"SINGLE",
				"readThroughSessionVariables":false,
				"includeTotalCount":false
			},
			"skip":false,
			"subTitle":"Storage by UnifyApps",
			"title":"Fetch records",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":117,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Fheb4-1",
			"id":"Hjcdr",
			"index":9,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"ui:submitButtonOptions":{
						"norender":true
					}
				},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"resolvedPrompt":{
							"type":"string",
							"title":"Resolved Prompt"
						}
					},
					"required":[]
				}
			},
			"inputs":{},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"resolvedPrompt":{
							"type":"string",
							"title":"Resolved Prompt"
						}
					},
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":47,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Fheb4-1",
			"id":"eo2AH",
			"index":10,
			"inputs":{
				"filters":[
					{
						"property":"{{ SE7zm.outputs.id }}",
						"filter":{
							"operator":"EXISTS"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"additional":{
				"visibleOptionalFields":[]
			},
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":55,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"eo2AH@Fheb4-1@y",
			"id":"ke5VS",
			"index":11,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"promptVariables":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Prompt Variables"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"input":{
					"type":"object",
					"properties":{
						"userQuery":{
							"type":"string",
							"title":"User Query"
						},
						"messageHistory":{
							"type":"array",
							"items":{
								"type":"object",
								"properties":{},
								"additionalProperties":false
							},
							"title":"Message History"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"return [\"promptVariables\": [\"userQuery\": userQuery, \"messageHistory\": userQuery]]",
				"isAsync":false,
				"parameters":{
					"userQuery":"{{ Jaq7M.outputs.userQuery }}",
					"messageHistory":{
						"source":"{{ Jaq7M.outputs.messageHistory }}",
						"ua:type":"mappedArray",
						"items":"{{ Jaq7M.outputs.messageHistory[0] }}"
					}
				}
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"template_by_unifyapps",
				"resourceVersion":80,
				"resourceName":"template_by_unifyapps_compile_template",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"eo2AH@Fheb4-1@y",
			"id":"sxzCa",
			"index":12,
			"inputs":{
				"input_schema":"{{ ke5VS.outputs.result.promptVariables }}",
				"template_content":"{{ SE7zm.outputs.properties.promptContent }}",
				"template_id":"random"
			},
			"skip":false,
			"subTitle":"Template by UnifyApps",
			"title":"Compile template",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":59,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"eo2AH@Fheb4-1@y",
			"id":"gm2Iu",
			"index":13,
			"inputs":{
				"variables":[
					{
						"source":"{{ Hjcdr.outputs.resolvedPrompt }}",
						"value":"{{ sxzCa.outputs.output }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":55,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"eo2AH@Fheb4-1@n",
			"id":"W8Dqj",
			"index":14,
			"inputs":{
				"output":{
					"type":"object",
					"properties":{
						"codeAutomations":{
							"type":"array",
							"items":{
								"type":"string"
							},
							"title":"Code Automations"
						}
					},
					"additionalProperties":false,
					"required":[]
				},
				"compile_static":false,
				"code":"return [\"codeAutomations\": [\"e_66bb8d9d0e6a0c6b9f5f2d61\", \"e_66bf38fed8418b4cd9d24461\", \"e_66bf3941d8418b4cd9d24462\", \"e_66c0589b3c582b340b641c14\", \"e_66c05a7d3c582b340b642389\"]]",
				"isAsync":false
			},
			"skip":false,
			"subTitle":"Code by UnifyApps",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"if_else",
				"resourceVersion":47,
				"resourceName":"if_else_condition",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"eo2AH@Fheb4-1@n",
			"id":"YZhki",
			"index":15,
			"inputs":{
				"filters":[
					{
						"property":"{{ W8Dqj.outputs.result.codeAutomations }}",
						"filter":{
							"operator":"NOT_CONTAINS",
							"value":"{{ Jaq7M.outputs.aiAgentId }}"
						}
					}
				],
				"operator":"AND"
			},
			"skip":false,
			"subTitle":"Condition",
			"title":"Condition",
			"type":"IF_ELSE"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":467,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"YZhki@eo2AH@Fheb4-1@n@y",
			"id":"n_PtC25",
			"index":16,
			"inputs":{
				"automationId":"682c6f948d04422e007feda1",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"caseId":"{{ 5BsUt.outputs.caseId }}"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"template_by_unifyapps",
				"resourceVersion":77,
				"resourceName":"template_by_unifyapps_compile_template",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"YZhki@eo2AH@Fheb4-1@n@y",
			"id":"Eyd9E",
			"index":17,
			"inputs":{
				"input_schema":{
					"user_query":"{{ Jaq7M.outputs.userQuery }}",
					"userContext":"{{ n_PtC25.outputs.context }}",
					"message_history":{
						"source":"{{ Jaq7M.outputs.messageHistory }}",
						"ua:type":"mappedArray",
						"items":{
							"role":"{{ Jaq7M.outputs.messageHistory[0].role }}",
							"content":"{{ Jaq7M.outputs.messageHistory[0].content }}"
						}
					}
				},
				"template_id":"e_66add500eca30023cd1afe63"
			},
			"skip":false,
			"subTitle":"Template by UnifyApps",
			"title":"Compile template",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":59,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"YZhki@eo2AH@Fheb4-1@n@y",
			"id":"r7Eia",
			"index":18,
			"inputs":{
				"variables":[
					{
						"source":"{{ Hjcdr.outputs.resolvedPrompt }}",
						"value":"{{ Eyd9E.outputs.output }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"template_by_unifyapps",
				"resourceVersion":80,
				"resourceName":"template_by_unifyapps_compile_template",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"YZhki@eo2AH@Fheb4-1@n@n",
			"id":"xBuBA",
			"index":19,
			"inputs":{
				"input_schema":{
					"user_query":"{{ Jaq7M.outputs.userQuery }}",
					"message_history":{
						"source":"{{ Jaq7M.outputs.messageHistory }}",
						"ua:type":"mappedArray",
						"items":"{{ Jaq7M.outputs.messageHistory[0] }}"
					}
				},
				"template_id":"e_66c2eba176bcff3c18cc8ee4"
			},
			"skip":false,
			"subTitle":"Template by UnifyApps",
			"title":"Compile template",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":59,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"YZhki@eo2AH@Fheb4-1@n@n",
			"id":"CvoWv",
			"index":20,
			"inputs":{
				"variables":[
					{
						"source":"{{ Hjcdr.outputs.resolvedPrompt }}",
						"value":"{{ xBuBA.outputs.output }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":114,
				"resourceName":"variable_by_unifyapps_create_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Fheb4-1",
			"id":"Acxdd",
			"index":21,
			"inputSchema":{
				"type":"SCHEMA_AND_LAYOUT",
				"dynamic":false,
				"layout":{
					"ui:submitButtonOptions":{
						"norender":true
					}
				},
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"llmResponse":{
							"type":"string",
							"title":"Llm Response"
						}
					},
					"required":[]
				}
			},
			"inputs":{},
			"outputSchema":{
				"dynamic":false,
				"schema":{
					"additionalProperties":false,
					"type":"object",
					"properties":{
						"llmResponse":{
							"type":"string",
							"title":"Llm Response"
						}
					},
					"required":[]
				}
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Create variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":138,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Fheb4-1",
			"id":"wW9pI",
			"index":22,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"message":{
							"type":"object",
							"properties":{},
							"additionalProperties":false,
							"title":"Message"
						}
					}
				},
				"input":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"prompt":{
							"type":"string",
							"title":"Prompt"
						}
					}
				},
				"code":"return [\"message\":[\"type\":\"text\", \"text\":prompt]]",
				"compile_static":false,
				"captureStdOutput":false,
				"parameters":{
					"prompt":"{{ Hjcdr.outputs.resolvedPrompt }}"
				}
			},
			"skip":false,
			"subTitle":"prompt to message",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":48,
				"resourceName":"callables_call_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Fheb4-1",
			"id":"rmKs1",
			"index":23,
			"inputs":{
				"automationId":"66ac70650f725f5b425d12d8",
				"runtimeConnections":{},
				"synchronous":true,
				"version":"-1",
				"parameters":{
					"logProbs":false,
					"aiAgentId":"{{ Jaq7M.outputs.aiAgentId }}",
					"modelId":"{{ n_cAeOK.outputs.properties.preProcessingSettings.queryRephrasingModel }}",
					"maxTokens":1024,
					"message":{
						"items":{
							"role":"user",
							"content":{
								"items":"{{ wW9pI.outputs.result.message }}",
								"ua:type":"mappedArray"
							}
						},
						"ua:type":"mappedArray"
					},
					"caseId":"{{ 5BsUt.outputs.caseId }}",
					"messageId":"{{ 5BsUt.outputs.messageId }}",
					"step":"Re-phraser",
					"responseFormat":{
						"type":"json_object"
					}
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Call automation",
			"type":"CALL_WORKFLOW"
		},
		{
			"context":{
				"appName":"code_by_unifyapps",
				"resourceVersion":2,
				"resourceName":"code_by_unifyapps_groovy",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Fheb4-1",
			"id":"6adYg",
			"index":24,
			"inputs":{
				"output":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"jsonInput":{
							"type":"string",
							"title":"Json Input"
						}
					}
				},
				"input":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"jsonInput":{
							"type":"string",
							"title":"Json Input"
						}
					}
				},
				"code":"def jsonInput = binding.hasVariable('jsonInput') ? jsonInput : \"\"\n\ndef startIndex = jsonInput.indexOf('{')\ndef endIndex = jsonInput.lastIndexOf('}')\n\nif (startIndex != -1 && endIndex != -1 && endIndex > startIndex) {\n    jsonInput = jsonInput.substring(startIndex, endIndex + 1).trim()\n} else {\n    jsonInput = \"\"\n}\nreturn [\"jsonInput\":jsonInput]",
				"compile_static":false,
				"isAsync":false,
				"captureStdOutput":false,
				"parameters":{
					"jsonInput":"{{ rmKs1.outputs.llmResponse }}"
				}
			},
			"skip":false,
			"subTitle":"clean LLM response",
			"title":"Execute Groovy code",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"variable_by_unifyapps",
				"resourceVersion":56,
				"resourceName":"variable_by_unifyapps_update_variables",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Fheb4-1",
			"id":"TkX7e",
			"index":25,
			"inputs":{
				"variables":[
					{
						"source":"{{ Acxdd.outputs.llmResponse }}",
						"value":"{{ 6adYg.outputs.result.jsonInput }}"
					}
				]
			},
			"skip":false,
			"subTitle":"Variable by UnifyApps",
			"title":"Update variables",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"utility_by_unifyapps",
				"resourceVersion":12,
				"resourceName":"utility_by_unifyapps_to_json_object",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Fheb4-1",
			"id":"n7cL3",
			"index":26,
			"inputs":{
				"jsonSchema":{
					"type":"object",
					"additionalProperties":false,
					"required":[],
					"properties":{
						"rephrased_user_message":{
							"type":"string",
							"title":"rephrased_user_message"
						},
						"reply":{
							"type":"string",
							"title":"reply"
						},
						"chit_chat":{
							"type":"string",
							"title":"chit_chat"
						},
						"retry_with_context":{
							"type":"boolean",
							"title":"Retry With Context"
						}
					}
				},
				"jsonString":"{{ Acxdd.outputs.llmResponse }}"
			},
			"skip":false,
			"subTitle":"Utility by UnifyApps",
			"title":"Deserialize string to json object",
			"type":"ACTION"
		},
		{
			"context":{
				"appName":"callables",
				"resourceVersion":42,
				"resourceName":"callables_return_to_automation",
				"type":"APPLICATION"
			},
			"debug":false,
			"dirty":false,
			"fallbackMode":"STOP",
			"groupId":"Fheb4-1",
			"id":"UxfaO",
			"index":27,
			"inputs":{
				"result":{
					"rephrased_user_message":"{{ n7cL3.outputs.result.rephrased_user_message }}",
					"reply":"{{ n7cL3.outputs.result.reply }}",
					"chit_chat":"{{ n7cL3.outputs.result.chit_chat }}",
					"retry_with_context":"{{ n7cL3.outputs.result.retry_with_context }}"
				}
			},
			"skip":false,
			"subTitle":"Callable",
			"title":"Respond to automation",
			"type":"STOP"
		}
	],
	"ownerUserId":295,
	"schemaReferences":[
		
	],
	"settings":{
		"enableNodeLevelLogging":true,
		"enableRunLogging":true,
		"enableVariableLogging":true,
		"route":{
			"default":false,
			"tierName":"global"
		}
	},
	"standard":true,
	"tags":[
		"AI Agent"
	],
	"version":138
}